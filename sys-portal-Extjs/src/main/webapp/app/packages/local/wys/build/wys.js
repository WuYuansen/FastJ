Ext.define("Ext.theme.neptune.Component",{override:"Ext.Component",initComponent:function(){this.callParent();if(this.dock&&this.border===undefined){this.border=false}},privates:{initStyles:function(){var c=this,b=c.hasOwnProperty("border"),a=c.border;if(c.dock){c.border=null}c.callParent(arguments);if(b){c.border=a}else{delete c.border}}}},function(){Ext.namespace("Ext.theme.is").Neptune=true;Ext.theme.name="Neptune"});Ext.define("Ext.theme.crisp.Component",{override:"Ext.Component"},function(){Ext.namespace("Ext.theme.is").Crisp=true;Ext.theme.name="Crisp"});Ext.define("wys.LoadMask",{override:"Ext.LoadMask",renderTpl:['<div id="{id}-msgWrapEl" data-ref="msgWrapEl" class="my_preloader my_spinner">','\t\t<div class="my_spinWrap" id="{id}-msgEl" data-ref="msgEl">','\t\t<p class="my_spinnerImage"></p>','\t\t<p class="my_loader"></p>','\t\t<p class="my_loadingMessage" data-ref="msgTextEl" id="{id}-msgTextEl">{msg}</p>','\t\t<p class="my_loadingSubHeading" id="spinnerSubHeading"></p>',"\t</div>","</div>"]});Ext.define("Ext.theme.neptune.resizer.Splitter",{override:"Ext.resizer.Splitter",size:8});Ext.define("Ext.theme.neptune.toolbar.Toolbar",{override:"Ext.toolbar.Toolbar",usePlainButtons:false,border:false});Ext.define("Ext.theme.neptune.layout.component.Dock",{override:"Ext.layout.component.Dock",noBorderClassTable:[0,Ext.baseCSSPrefix+"noborder-l",Ext.baseCSSPrefix+"noborder-b",Ext.baseCSSPrefix+"noborder-bl",Ext.baseCSSPrefix+"noborder-r",Ext.baseCSSPrefix+"noborder-rl",Ext.baseCSSPrefix+"noborder-rb",Ext.baseCSSPrefix+"noborder-rbl",Ext.baseCSSPrefix+"noborder-t",Ext.baseCSSPrefix+"noborder-tl",Ext.baseCSSPrefix+"noborder-tb",Ext.baseCSSPrefix+"noborder-tbl",Ext.baseCSSPrefix+"noborder-tr",Ext.baseCSSPrefix+"noborder-trl",Ext.baseCSSPrefix+"noborder-trb",Ext.baseCSSPrefix+"noborder-trbl"],edgeMasks:{top:8,right:4,bottom:2,left:1},handleItemBorders:function(){var y=this,f=0,z=8,A=4,l=2,e=1,a=y.owner,s=a.bodyBorder,n=a.border,j=y.collapsed,p=y.edgeMasks,k=y.noBorderClassTable,x=a.dockedItems.generation,w,d,v,h,r,m,u,o,g,q,t,c;if(y.initializedBorders===x){return}t=[];c=[];d=y.getBorderCollapseTable();k=y.getBorderClassTable?y.getBorderClassTable():k;y.initializedBorders=x;y.collapsed=false;v=y.getDockedItems("visual");y.collapsed=j;for(r=0,m=v.length;r<m;r++){u=v[r];if(u.ignoreBorderManagement){continue}o=u.dock;q=h=0;t.length=0;c.length=0;if(o!=="bottom"){if(f&z){w=u.border}else{w=n;if(w!==false){h+=z}}if(w===false){q+=z}}if(o!=="left"){if(f&A){w=u.border}else{w=n;if(w!==false){h+=A}}if(w===false){q+=A}}if(o!=="top"){if(f&l){w=u.border}else{w=n;if(w!==false){h+=l}}if(w===false){q+=l}}if(o!=="right"){if(f&e){w=u.border}else{w=n;if(w!==false){h+=e}}if(w===false){q+=e}}if((g=u.lastBorderMask)!==q){u.lastBorderMask=q;if(g){c[0]=k[g]}if(q){t[0]=k[q]}}if((g=u.lastBorderCollapse)!==h){u.lastBorderCollapse=h;if(g){c[c.length]=d[g]}if(h){t[t.length]=d[h]}}if(c.length){u.removeCls(c)}if(t.length){u.addCls(t)}f|=p[o]}q=h=0;t.length=0;c.length=0;if(f&z){w=s}else{w=n;if(w!==false){h+=z}}if(w===false){q+=z}if(f&A){w=s}else{w=n;if(w!==false){h+=A}}if(w===false){q+=A}if(f&l){w=s}else{w=n;if(w!==false){h+=l}}if(w===false){q+=l}if(f&e){w=s}else{w=n;if(w!==false){h+=e}}if(w===false){q+=e}if((g=y.lastBodyBorderMask)!==q){y.lastBodyBorderMask=q;if(g){c[0]=k[g]}if(q){t[0]=k[q]}}if((g=y.lastBodyBorderCollapse)!==h){y.lastBodyBorderCollapse=h;if(g){c[c.length]=d[g]}if(h){t[t.length]=d[h]}}if(c.length){a.removeBodyCls(c)}if(t.length){a.addBodyCls(t)}},onRemove:function(d){var c=this,b=d.lastBorderMask,a=d.lastBorderCollapse;if(!d.destroyed&&!d.ignoreBorderManagement){if(b){d.lastBorderMask=0;d.removeCls(c.noBorderClassTable[b])}if(a){d.lastBorderCollapse=0;d.removeCls(c.getBorderCollapseTable()[a])}}c.callParent([d])}});Ext.define("Ext.theme.neptune.panel.Panel",{override:"Ext.panel.Panel",border:false,bodyBorder:false,initBorderProps:Ext.emptyFn,initBodyBorder:function(){if(this.bodyBorder!==true){this.callParent()}}});Ext.define("wys.panel.Panel",{override:"Ext.panel.Panel",closeToolText:"关闭面板",collapseToolText:"折叠面板"});Ext.define("Ext.theme.neptune.container.ButtonGroup",{override:"Ext.container.ButtonGroup",usePlainButtons:false});Ext.define("wys.form.field.Base",{override:"Ext.form.field.Base",subTplInsertions:["inputAttrTpl","fieldPostfix","fieldPrefix"]});Ext.define("wys.form.field.VTypes",{override:"Ext.form.field.VTypes",rate:function(d,b){var a=b.max,c=b.min,d=Number(d);if(d+""!="NaN"){if(d>=c&&d<=a){b.vtypeText="输入值范围为"+c+"到"+a;return true}}else{b.vtypeText="只能输入>=0的数值"}},compareMaxMin:function(c,b){var e=b.maxObj,f=b.minObj,c=Number(b.getValue());if(c+""!="NaN"){if(f){var a=Number(b.up("[viewModel]").down("[tag="+f+"]").getValue());if(c>=a){return true}else{b.vtypeText="请输入比"+a+"大的数值";return false}}else{if(e){var d=Number(b.up("[viewModel]").down("[tag="+e+"]").getValue());if(c<=d||d==""){return true}else{b.vtypeText="请输入比"+d+"小的数值";return false}}}}else{b.vtypeText="只能输入>=0的数值"}},compareDependentMaxMin:function(b,c){var g,h,f,d=c.compareGroup,a=Ext.ComponentQuery.query("[compareGroup="+d+"]"),e=Number(c.getValue());Ext.each(a,function(k,j,i){if(k.dependent!=undefined){f=k}});Ext.each(a,function(l,k,j){var i=f;if(i.dependent[i.getValue()]=="less"){if(k==0){l.tag=d+"minObj";l.maxObj=d+"maxObj";if(l.minObj){delete l.minObj}}if(k==2){l.tag=d+"maxObj";l.minObj=d+"minObj";if(l.maxObj){delete l.maxObj}}}else{if(k==0){l.tag=d+"maxObj";l.minObj=d+"minObj";if(l.maxObj){delete l.maxObj}}if(k==2){l.tag=d+"minObj";l.maxObj=d+"maxObj";if(l.minObj){delete l.minObj}}}});return true},card:function(a,b){},userName:function(d,e){var c=this,b,a;b=c.checkEmail(d);a=c.checkMobile(d);if(b||a){return true}else{return false}return true},code:function(e,b){var d={},c="";var a="验证码请求地址";d.code=e.toUpperCase();d.regType=-1;Ext.Ajax.request({method:"POST",url:a,params:d,async:false,success:function(f,g){c=f.responseText}});return c=="1"?true:false},checkEmail:function(c,a){var b=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;a.vtypeText="请输入正确的Email";return b.test(c.toLowerCase())},checkMobile:function(b){var a=/^((\+?86)|(\(\+86\)))?1\d{10}$/;return a.test(b.replace(/\-/g,""))},maxInputLength:function(d,c){var b=c.maxlen;var a=d.length;if(b>=a){return true}else{c.vtypeText="您输入的内容超出长度"}},cardText:function(e,a){var d={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外 "};var c="";var b=true;if(!e||!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e)){a.vtypeText="身份证号格式错误";b=false}else{if(!d[e.substr(0,2)]){a.vtypeText="地址编码错误";b=false}else{}}return b},checkIknowId:function(c,a){var b=/^(\+?[1-9][0-9]*|0)$/;a.vtypeText="请输入正确的企业账号";return b.test(c)},checkRegCode:function(c,a){var b=/^\+?[1-9][0-9]*$/;a.vtypeText="请输入正确的执照号码";return b.test(c)},checkServiceEmCount:function(c,a){var b=/^[1-9][0-9]{0,4}$/;a.vtypeText="请输入正确的服务人数（最大长度5位的正整数）";return b.test(c)},checkAddress:function(c,a){var b=/^[0-9a-zA-Z\u4e00-\u9fa5]+$/;a.vtypeText="请输入正确的地址（只能输入中文或英文或数字）";return b.test(c)},checkChainese:function(c,a){var b=/^[\u4e00-\u9fa5]+$/;a.vtypeText="只能输入中文";return b.test(c)},checkWebSite:function(c,a){var b=/^[wW]{3}\.[\w-]+\.\w{2,4}(\/.*)?$/;a.vtypeText="请输入正确的网址（www开头）";return b.test(c)},checkMobile:function(c,a){var b=/^1[1-9]\d{9}$/;a.vtypeText="请输入正确的手机号码（11位数字）";return b.test(c)},checkMobildAndTel:function(c,a){var b=/^((0\d{2,3}-\d{7,8})|(1[3584]\d{9}))$/;a.vtypeText="您输入的联系方式有误请重写输入座机格式0000-000000手机13*********";return b.test(c)},checkFax:function(c,a){var b=/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/;a.vtypeText="请输入正确的号码";return b.test(c)},checkName:function(c,a){var b=/^[a-zA-Z?:·\u4e00-\u9fa5]+$/;a.vtypeText="请输入正确的姓名，只能含汉字和字母";return b.test(c)},checkPy:function(c,a){var b=/^[a-zA-Z]+$/;a.vtypeText="此输入项不正确，只能输入字母";return b.test(c)},repetition:function(c,b){if(b.repetition){var a=b.up("form").getForm().findField(b.repetition.targetCmpId);if(Ext.isEmpty(a)){util.err("发生异常错误，指定的组件未找到");return false}if(c==a.getValue()){return true}else{return false}}},repetitionText:"两次输入的值不一致请检查",dateRange:function(d,c){var b=c.parseDate(d);if(!b){return}if(c.startDateField&&(!this.dateRangeMax||(b.getTime()!=this.dateRangeMax.getTime()))){var e=c.up().down("datefield[name="+c.startDateField+"]");e.setMaxValue(b);e.validate();this.dateRangeMax=b}else{if(c.endDateField&&(!this.dateRangeMin||(b.getTime()!=this.dateRangeMin.getTime()))){var a=c.up().down("datefield[name="+c.endDateField+"]");a.setMinValue(b);a.validate();this.dateRangeMin=b}}return true},daterangeText:"开始时间必须小于结束时间",checkIP:function(c,a){var b=/^(1|([1-9]{1,2}|[1-9]0)|(1[0-9]{2}|2[0-5]{2}))((.(0|([1-9]{1,2}|[1-9]0)|(1[0-9]{2}|2[0-5]{2}))){2}).(1|([1-9]{1,2}|[1-9]0)|(1[0-9]{2}|2[0-5]{2}))$/;a.vtypeText="请输入正确的IP地址，例如：192.168.0.1";return b.test(c)}});Ext.define("wys.tip.Tip",{override:"Ext.tip.Tip"});Ext.define("wys.form.field.Text",{override:"Ext.form.field.Text",listeners:{focus:function(a){a.setHideTrigger(false)},blur:function(a){a.setHideTrigger(true)},render:function(a){a.setHideTrigger(true)}},hideTrigger:true,triggerCls:"x-form-clear-trigger",onTriggerClick:function(){this.setValue("")},afterRender:Ext.Function.createSequence(Ext.form.field.Text.prototype.afterRender,function(){var a=this;if(this.readOnly===true){a.setFieldStyle({cursor:"not-allowed"})}if(a.allowBlank===false){if(!a.afterLabelTextTpl){a.afterLabelTextTpl=required}}if(a.xtype==="ArrayCombobox"||a.xtype==="combgrid"||a.xtype==="RemoteCombobox"||a.xtype==="cityPicker"||a.xtype==="combobox"||a.xtype==="datetimefield"||a.xtype==="comboTree"){return}if(a.tooltip){try{Ext.create("Ext.ToolTip",{target:a.id,trackMouse:false,draggable:true,maxWidth:200,minWidth:100,title:a.tooltip.title||"输入提示",html:a.tooltip.text||"请输入"+a.fieldLabel})}catch(b){}}else{try{Ext.create("Ext.ToolTip",{target:a.id,trackMouse:false,draggable:true,maxWidth:200,minWidth:100,title:"输入提示",html:"请输入"+(a.fieldLabel||a.emptyText.replace("请输入",""))})}catch(b){}}})});Ext.define("wys.Window.MessageBox",{override:"Ext.window.MessageBox",init:function(a){this.win=a;this.win.buttonText={ok:WY.local.lang.common.okButtonText,yes:WY.local.lang.common.yesButtonText,no:WY.local.lang.common.cancelButtonText,cancel:WY.local.lang.common.noButtonText}},confirm:function(a,d,c,b){this.msgButtons[2].setUI("button-alternative-toolbar");if(Ext.isString(a)){a={title:a,icon:this.QUESTION,message:d,buttons:this.YESNO,callback:c,scope:b}}return this.show(a)}});Ext.define("wys.form.FieldContainer",{override:"Ext.form.FieldContainer",initRenderData:function(){var a=this.callParent();a.containerElCls=this.containerElCls;return a},setFieldLabel:function(d){d=d||"";var e=this,f=e.labelSeparator,c=e.labelEl,b=e.errorWrapEl,h=(e.labelAlign!=="top"),a=e.noLabelCls,g=e.errorWrapUnderSideLabelCls;e.fieldLabel=d;if(e.rendered){if(Ext.isEmpty(d)&&e.hideEmptyLabel){e.addCls(a);if(h&&b){b.removeCls(g)}}else{if(f){d=e.trimLabelSeparator()+f}if(e.afterLabelTextTpl){c.dom.firstChild.innerHTML=d+e.afterLabelTextTpl}else{c.dom.firstChild.innerHTML=d}e.removeCls(a);if(h&&b){b.addCls(g)}}e.updateLayout()}},setToolTip:function(c,b,d){c=c||"";b=b||"my-tooltip";var e=this;var a=e.getElementsByCls(b);if(a.length){Ext.each(a,function(f){f.setAttribute("data-qtip",c);if(d){f.style.display="inline-block"}})}else{e.showToolTip(c,b)}},showToolTip:function(d,c){var e=this;d=d||"";c=c||"my-tooltip";var a=e.getElementsByCls(c);if(a.length){Ext.each(a,function(g){g.style.display="inline-block"})}else{var f=e.getElementsByCls("x-form-item-label-inner");var b='<span data-qtip="'+d+'" style="color:red;cursor: pointer;padding-left:10px;-webkit-transform: scale(1.5);transform: scale(1.5);" class="fa fa-question-circle my-tooltip"></span>';Ext.each(f,function(g){if(g.parentElement.parentElement.id.indexOf("fieldcontainer-")>-1){g.innerHTML+=b}})}},getElementsByCls:function(a){var b=this;var c=[];if(!b.el||!b.el.dom){return c}if(b.el.dom.getElementsByClassName){c=b.el.dom.getElementsByClassName(a)}else{if(b.el.dom.querySelector){c=b.el.dom.querySelectorAll("."+a)}else{var e=ssbasemsg.el.dom.getElementsByTagName("*");var d=new RegExp("(^"+a+"$)|(^"+a+"\\s)|(\\s"+a+"\\s)|(\\s"+a+"$)");Ext.each(e,function(f){if(d.test(f.className)){c.push(f)}})}}return c}});Ext.define("wys.form.field.Number",{override:"Ext.form.field.Number",negativeText:"输入的值不合法",afterRender:Ext.Function.createSequence(Ext.form.Number.prototype.afterRender,function(){var a=this;a.maxValue=a.maxValue||9999999999;if(!a.emptyText){a.emptyText="0.00"}})});Ext.define("Ext.theme.neptune.toolbar.Paging",{override:"Ext.toolbar.Paging",defaultButtonUI:"plain-toolbar",inputItemWidth:40});Ext.define("wys.toolbar.Paging",{override:"Ext.toolbar.Paging",isShow:true,initComponent:function(){var a=this;a.displayInfo=true,a.beforePageText=WY.local.lang.common.pagingtoolbar.beforePageText;a.displayMsg=WY.local.lang.common.pagingtoolbar.displayMsg;a.emptyMsg=WY.local.lang.common.pagingtoolbar.emptyMsg;a.refreshText=WY.local.lang.common.pagingtoolbar.refreshText;a.firstText=WY.local.lang.common.pagingtoolbar.firstText;a.prevText=WY.local.lang.common.pagingtoolbar.prevText;a.nextText=WY.local.lang.common.pagingtoolbar.nextText;a.lastText=WY.local.lang.common.pagingtoolbar.lastText;a.items=[{xtype:"combobox",fieldLabel:WY.local.lang.common.pagingtoolbar.DisplayPage,width:120,editable:false,hidden:!a.isShow,labelWidth:60,store:["10","20","25","30","50","100"],value:constants.pagingtoolbar.pageSize,listeners:{afterrender:function(c,b){c.setValue(constants.pagingtoolbar.pageSize)},select:function(f,c,d){var e=f.ownerCt,b=e.getStore();b.pageSize=f.getValue();b.currentPage=1;e.doRefresh()}}},{hidden:!a.isShow,xtype:"label",style:"padding:7px 0px 0px 0px;color:#6f757b;",text:WY.local.lang.common.pagingtoolbar.strip}];a.callParent();a.on("afterrender",function(){a.ownerCt.on("reconfigure",function(){a.bindStore(a.ownerCt.store||"ext-empty-store",true)})})}});Ext.define("Ext.theme.neptune.picker.Month",{override:"Ext.picker.Month",measureMaxHeight:36});Ext.define("wys.form.field.Display",{override:"Ext.form.field.Display"});Ext.define("Ext.theme.neptune.form.field.HtmlEditor",{override:"Ext.form.field.HtmlEditor",defaultButtonUI:"plain-toolbar"});Ext.define("Ext.theme.neptune.panel.Table",{override:"Ext.panel.Table",lockableBodyBorder:true,initComponent:function(){var a=this;a.callParent();if(!a.hasOwnProperty("bodyBorder")&&!a.hideHeaders&&(a.lockableBodyBorder||!a.lockable)){a.bodyBorder=true}}});Ext.define("Ext.theme.crisp.view.Table",{override:"Ext.view.Table",stripeRows:false});Ext.define("wys.grid.Panel",{override:"Ext.grid.Panel",afterRender:Ext.Function.createSequence(Ext.grid.GridPanel.prototype.afterRender,function(){var a=this.getView();this.tip=new Ext.ToolTip({target:a.el,delegate:".x-grid-cell-inner",trackMouse:true,renderTo:Ext.getBody(),listeners:{beforeshow:function b(d){var c=(d.triggerElement.innerText||d.triggerElement.textContent);if(Ext.isIE8){d.update(c);return}if(Ext.isEmpty(c)||Ext.isEmpty(window.util.trim(c))){return false}d.update(c)}}})})});Ext.define("Ext.theme.neptune.grid.RowEditor",{override:"Ext.grid.RowEditor",buttonUI:"default-toolbar"});Ext.define("Ext.theme.neptune.grid.column.RowNumberer",{override:"Ext.grid.column.RowNumberer",width:25});Ext.define("Ext.theme.neptune.menu.Separator",{override:"Ext.menu.Separator",border:true});Ext.define("Ext.theme.neptune.menu.Menu",{override:"Ext.menu.Menu",showSeparator:false});Ext.define("wys.grid.plugin.RowEditing",{override:"Ext.grid.plugin.RowEditing",saveBtnText:"保存",cancelBtnText:"取消",errorsText:"错误提示",dirtyText:"请先提交或取消操作"});Ext.define("wys.grid.plugin.RowExpander",{override:"Ext.grid.plugin.RowExpander",init:function(a){this.callParent(arguments);this.grid=a;this.grid.fireEvent("collapsebody","expandbody")},toggleRow:function(b,e){var g=this,i=g.view,c=i.getNode(b),l=Ext.fly(c,"_rowExpander"),f=l.down(g.rowBodyTrSelector,true),d=l.hasCls(g.rowCollapsedCls),j=d?"removeCls":"addCls",h,a,k;Ext.suspendLayouts();l[j](g.rowCollapsedCls);if(!Ext.isEmpty(Ext.fly(f))){Ext.fly(f)[j](g.rowBodyHiddenCls)}g.recordsExpanded[e.internalId]=d;i.refreshSize();if(g.grid.ownerLockable){h=g.grid.ownerLockable;i=h.lockedGrid.view;k=h.lockedGrid.view;a=l.getHeight();l.setHeight(d?a:"");l=Ext.fly(i.getNode(b),"_rowExpander");l.setHeight(d?a:"");l[j](g.rowCollapsedCls);i.refreshSize()}else{k=i}this.grid.fireEvent(d?"expandbody":"collapsebody",Ext.isEmpty(l.dom)?l:l.dom,e,f);Ext.resumeLayouts(true)}});Ext.define("wys.tab.Panel",{override:"Ext.tab.Panel"});Ext.define("wys.Main",{extend:"Ext.container.Container"});Ext.define("wys.basic.BaseCtrl",{extend:"Ext.app.ViewController"});Ext.define("wys.basic.BaseForm",{extend:"Ext.form.Panel",xtype:"baseForm",requires:["Ext.form.Panel"],fieldDefaults:{labelAlign:"right",labelWidth:100}});Ext.define("wys.basic.BaseView",{extend:"Ext.grid.Panel",xtype:"baseView",requires:[],border:1,loadMask:true,minHeight:100,enableColumnHide:true,border:false,bodyBorder:false,loadMask:{msg:"正在加载数据,请稍等..."},columnLines:false,viewConfig:{emptyText:'<div style="margin: 10px;padding: 15px;background: #f9edc0;border: 1px solid #d2a04a !important;color: black;-webkit-border-radius: 5px;-moz-border-radius: 5px;">没有找到相关记录<div>',stripeRows:false,enableTextSelection:true,stripeRows:false,getRowClass:function(a,d,c,b){if(d%2===0){return"x-grid-row-hight"}}},initComponent:function(){this.callParent(arguments)}});Ext.define("wys.basic.BaseWin",{extend:"Ext.window.Window",alias:"widget.baseWin",autoShow:true,requires:["Ext.window.Window"],modal:true,maximizable:true,closeAction:"hide",layout:"fit",autoScroll:true,animCollapse:true,animateTarget:Ext.getBody(),border:true,isCenter:false,style:"border-color: #b6babe;",closeToolText:"点击关闭窗口",afterRender:function(){var a=this;if(!a.isCenter){a.x=Ext.ComponentQuery.query("container[name=leftMenu]")[0].getWidth()+0;a.y=Ext.ComponentQuery.query("headerBar")[0].getHeight()+37;this.iconCls=a.iconCls||""}a.callParent(arguments);if(!a.isCenter){if(a.width&a.height){}else{if(a.width){a.syncSizeByHeight(a.mainWidth)}else{a.syncSize()}}Ext.on(a.resizeListeners={resize:a.onViewportResize,scope:a,buffer:50})}},onDestroy:function(){Ext.un(this.resizeListeners);this.callParent()},onViewportResize:function(){this.syncSize()},syncSize:function(){var d=this,e=Ext.Element.getViewportWidth(),c=Ext.Element.getViewportHeight(),b=d.x,g=d.y,a=e-b,f=c-(g+40);d.setSize(a,f);d.setXY([b,g])},syncSizeByHeight:function(c){var d=c,e=this,b=Ext.Element.getViewportHeight(),a=e.x,f=e.y;e.setSize(e.mainWidth,e.mainHeight);e.setXY([a,f])}});Ext.define("wys.basic.SeniorQuery",{extend:"Ext.menu.Menu",xtype:"seniorQuery",width:350,searchFields:[],usePageFuncScope:null,userPageFuncStore:null,initComponent:function(){var a=this;if(a.usePageFuncScope===null||a.usePageFuncScope===undefined){util.err("高级查询组件初始化异常，缺少【usePageFuncScope】参数")}else{if(a.usePageFuncScope===null||a.usePageFuncScope===undefined){util.err("高级查询组件初始化异常，缺少【userPageFuncStore】参数")}else{Ext.apply(a,{width:a.width,margin:"0 0 10 0",items:[{title:"高级检索",tools:[{type:"close",tooltip:"点击关闭",handler:function(){this.up("menu").close()}}],iconCls:"fa fa-search fa-lg",xtype:"form",width:350,defaults:{anchor:"100%",labelWidth:100,labelSeparator:"：",labelAlign:"right",margin:5},defaultType:"textfield",items:a.searchFields,buttons:[{text:"重置查询",ui:"button-commonToolbarBtn-toolbar",iconCls:"fa fa-share fa-fw",handler:function(){this.up("form").getForm().reset()}},{text:"查询",xtype:"searchBtn",formBind:true,disabled:true,handler:function(){var b=this.up("form").getForm();if(b.isValid()){store.proxy.extraParams=b.getValues();store.currentPage=1;store.load()}}}]}]})}}a.callParent(arguments)}});Ext.define("wys.basic.specialGridpanel",{extend:"wys.basic.BaseView",xtype:"specialGridPanel",alias:"widget.specialGridPanel",requires:["wys.basic.BaseView"],url:new Array(),params:{},listeners:{afterrender:function(a,b){var c=this;var d={url:c.url[0],params:c.params,ok:function(f){loadDateItem=f.list;cmItems=[];cmItems.push({xtype:"rownumberer",text:"序号",align:"center",width:50,sortable:false});Ext.Array.each(loadDateItem,function(h){if(h.children===undefined||h.children.length==0){cmItems.push({text:h.text,flex:1,dataIndex:h.dataIndex,menuDisabled:true,sortable:false})}else{itemsF={text:h.text,menuDisabled:true,sortable:false};var g=[];Ext.Array.each(h.children,function(i){g.push({text:i.text,flex:1,menuDisabled:true,sortable:false})});itemsF.columns=g;cmItems.push(itemsF)}});cmItems.push({text:"",align:"center",width:15,sortable:false,menuDisabled:true});var e=Ext.create("Ext.data.Store",{fields:f.root,proxy:{type:"ajax",url:c.url[1],reader:{type:"json",rootProperty:"list"}},autoLoad:true,listeners:{beforeload:function(g){Ext.apply(g.proxy.extraParams,c.params);g.currentPage=1}}});Ext.suspendLayouts();a.reconfigure(e,cmItems);e.load(function(h,g,i){window.util.mergeCells(a,"row","kinds","1px solid #9BCEDB")});Ext.resumeLayouts(true)}};window.util.ajax(d)}},initComponent:function(){var a=this;a.margin="0 0 0 0";a.columnLines=false;a.viewConfig={stripeRows:true,enableTextSelection:true};this.callParent(arguments)}});Ext.define("wys.button.BizReturn",{extend:"Ext.button.Button",xtype:"bizReturnBtn",ui:"button-biaReturn-toolbar",iconCls:"fa fa-file-excel-o fa-lw",text:"退件",tooltip:'<span style="font-size:12px"> 点击退办</span>'});Ext.define("wys.button.Button",{extend:"Ext.button.Button",xtype:"basicBtn",ui:"button-commonToolbarBtn-toolbar"});Ext.define("wys.button.Exp",{extend:"Ext.button.Button",xtype:"expBtn",ui:"button-expbtn-toolbar",iconCls:"fa fa-file-excel-o fa-lw",text:"导出数据",tooltip:'<span style="font-size:12px">点击进行数据导出</span>',isLocalStore:false,columnsStr:"",searchSQL:"",tempFileName:"",handler:function(a){if(!Ext.isEmpty(a.columnsStr)||!Ext.isEmpty(a.searchSQL)||!Ext.isEmpty(a.tempFileName)){util.ajax({url:app.base+"/excel/download.do",params:{tempFileName:a.tempFileName,columns:a.columnsStr,sql:a.searchSQL},ok:function(b){if(b.success){window.open(app.base+"/"+b.path)}else{util.err(WY.local.lang.common.tip.exp.downloadError)}}})}else{}}});Ext.define("wys.button.Imp",{extend:"Ext.button.Button",xtype:"impBtn",ui:"button-impbtn-toolbar",iconCls:"fa fa-file-excel-o fa-lw",text:"导入数据",tooltip:'<span style="font-size:12px">点击进行数据导入</span>',menu:[{text:"excel导入",iconCls:"fa fa-file-excel-o fa-lg",handler:function(a){var b=Ext.create("Ext.window.Window",{title:a.text,width:432,height:87,iconCls:a.iconCls,autoShow:true,modal:true,maximizable:false,closeAction:"destroy",layout:"fit",autoScroll:true,border:true,closeToolText:"点击关闭窗口",items:[{xtype:"filefield",name:"excelFile",fieldLabel:"excel文件",labelWidth:80,msgTarget:"side",allowBlank:false,anchor:"100%",buttonText:"请选择",emptyText:"请选择要导入的excel文件..."}]});b.show()}},"-",{text:"xml导入",iconCls:"fa fa-file-code-o fa-lg",handler:function(a){var b=Ext.create("Ext.window.Window",{title:a.text,width:432,height:87,iconCls:a.iconCls,autoShow:true,modal:true,maximizable:false,closeAction:"destroy",layout:"fit",autoScroll:true,border:true,closeToolText:"点击关闭窗口",items:[{xtype:"filefield",name:"xmlFile",fieldLabel:"xml文件",labelWidth:80,allowBlank:false,anchor:"100%",buttonText:"请选择"}]});b.show()}},"-",{text:"中心库导入",iconCls:"fa fa-align-center fa-lg",handler:function(a){}}]});Ext.define("wys.button.Modify",{extend:"Ext.button.Button",xtype:"modifyBtn",ui:"button-editcontent-toolbar",iconCls:"fa fa-edit fa-lg",text:"修改",tooltip:'<span style="font-size:12px">点击进行修改操作</span>'});Ext.define("wys.button.Pickup",{extend:"Ext.button.Button",xtype:"pickupBtn",ui:"button-pickup-toolbar",iconCls:"fa fa-file-excel-o fa-lw",text:"取件",tooltip:'<span style="font-size:12px"> 点击获取办理要件</span>'});Ext.define("wys.button.Refresh",{extend:"Ext.button.Button",xtype:"refreshBtn",ui:"button-refreshbtn-toolbar",iconCls:"fa fa-refresh fa-lg",text:"重新加载",tooltip:'<span style="font-size:12px">点击进行刷新操作</span>'});Ext.define("wys.button.Remove",{extend:"Ext.button.Button",xtype:"removeBtn",ui:"button-removebtn-toolbar",iconCls:"fa fa-trash-o fa-lg",text:"删除",tooltip:'<span style="font-size:12px">点击进行删除操作</span>'});Ext.define("wys.button.Save",{extend:"Ext.button.Button",xtype:"saveBtn",ui:"button-savebtn-toolbar",iconCls:"fa fa-plus-circle fa-lg",text:"新增",tooltip:'<span style="font-size:12px">点击进行新增操作</span>'});Ext.define("wys.button.Search",{extend:"Ext.button.Button",xtype:"searchBtn",ui:"button-searchbtn-toolbar",iconCls:"fa fa-search fa-lw",text:"查询",tooltip:'<span style="font-size:12px">点击进行数据检索</span>'});Ext.define("wys.button.Sync",{extend:"Ext.button.Button",xtype:"syncBtn",ui:"button-syncbtn-toolbar",iconCls:"fa fa-recycle fa-lw",text:"同步",tooltip:'<span style="font-size:12px">点击进行数据同步</span>'});Ext.define("wys.button.Text",{extend:"Ext.button.Button",xtype:"textBtn",ui:"button-textbtn-toolbar"});Ext.define("wys.ux.FileUpload",{extend:"Ext.grid.Panel",alias:"widget.uploadPanel",width:700,height:300,bizCode:"",fileType:"",busitypeid:"",columns:[{xtype:"rownumberer"},{text:"文件名",width:100,dataIndex:"name"},{text:"自定义文件名",width:130,dataIndex:"fileName"},{text:"类型",width:70,dataIndex:"type"},{text:"大小",width:70,dataIndex:"size",renderer:function(a){return Ext.util.Format.fileSize(a)}},{text:"进度",width:130,dataIndex:"percent",renderer:function(a){var b='<div><div style="border:1px solid #008000;height:10px;width:115px;margin:2px 0px 1px 0px;float:left;"><div style="float:left;background:#FFCC66;width:'+a+'%;height:8px;"><div></div></div></div></div>';return b}},{text:"状态",width:80,dataIndex:"status",renderer:function(b){var a;if(b==-1){a="等待上传"}else{if(b==-2){a="上传中..."}else{if(b==-3){a="<div style='color:red;'>上传失败</div>"}else{if(b==-4){a="上传成功"}else{if(b==-5){a="停止上传"}}}}}return a}},{xtype:"actioncolumn",width:50,items:[{iconCls:"fa fa-close fa-lg",tooltip:"移除任务",handler:function(b,d,a){var c=b.store.getAt(d).get("id");b.store.remove(b.store.getAt(d))}}]}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],store:Ext.create("Ext.data.JsonStore",{autoLoad:false,fields:["id","name","type","size","percent","status","fileName"]}),addFileBtnText:"添加附件",uploadBtnText:"开始上传",removeBtnText:"移除所有任务",cancelBtnText:"取消",debug:false,file_size_limit:100,file_types:"*.*",file_types_description:"所有文件",file_upload_limit:50,file_queue_limit:0,post_params:{attach_name:"",attach_table:"",attach_bizCode:"",attach_type:""},upload_url:constants.url.fileUpload,flash_url:Ext.String.format("{0}/resources/plupload/swfupload.swf",WY.local.loadScriptPrefix),flash9_url:Ext.String.format("{0}/resources/plupload/swfupload_fp9.swf",WY.local.loadScriptPrefix),initComponent:function(){this.post_params.attach_bizCode=this.bizCode;this.post_params.attach_type=this.fileType;this.post_params.attach_table=this.busitypeid;this.dockedItems=[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"addFileBtn",iconCls:"fa fa-plus fa-lg",text:this.addFileBtnText},{xtype:"tbseparator"},{xtype:"button",itemId:"uploadBtn",iconCls:"fa fa-cloud-upload fa-lg",text:this.uploadBtnText,scope:this,handler:this.onUpload},{xtype:"tbseparator"},{xtype:"button",itemId:"removeBtn",iconCls:"fa fa-trash-o fa-lg",text:this.removeBtnText,scope:this,handler:this.onRemove},{xtype:"tbseparator"},{xtype:"button",itemId:"cancelBtn",iconCls:"fa fa-close fa-lg",disabled:true,text:this.cancelBtnText,scope:this,handler:this.onCancelUpload}]}];this.callParent();this.down("button[itemId=addFileBtn]").on({afterrender:function(b){var a=this.getSWFConfig(b);this.swfupload=new SWFUpload(a);Ext.get(this.swfupload.movieName).setStyle({position:"absolute",top:0,left:-2})},scope:this,buffer:300})},getSWFConfig:function(c){var d=this;var b=Ext.id();var a=c.getEl().child("em");if(a==null){a=Ext.get(c.getId()+"-btnWrap")}a.setStyle({position:"relative",display:"block"});a.createChild({tag:"div",id:b});return{debug:d.debug,flash_url:d.flash_url,flash9_url:d.flash9_url,upload_url:d.upload_url,post_params:d.post_params||{savePath:"file\\"},file_size_limit:(d.file_size_limit*1024),file_types:d.file_types,file_types_description:d.file_types_description,file_upload_limit:d.file_upload_limit,file_queue_limit:d.file_queue_limit,button_width:a.getWidth(),button_height:a.getHeight(),button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,button_cursor:SWFUpload.CURSOR.HAND,button_placeholder_id:b,custom_settings:{scope_handler:d},swfupload_preload_handler:d.swfupload_preload_handler,file_queue_error_handler:d.file_queue_error_handler,swfupload_load_failed_handler:d.swfupload_load_failed_handler,upload_start_handler:d.upload_start_handler,upload_progress_handler:d.upload_progress_handler,upload_error_handler:d.upload_error_handler,upload_success_handler:d.upload_success_handler,upload_complete_handler:d.upload_complete_handler,file_queued_handler:d.file_queued_handler}},swfupload_preload_handler:function(){if(!this.support.loading){Ext.Msg.show({title:"提示",msg:"浏览器Flash Player版本太低,不能使用该上传功能！,请<a href="+app.base+'/doc/flash_notHave.pdf target="_black" style="color:blue;">点击</a>进行指导安装',icon:Ext.Msg.ERROR,buttons:Ext.Msg.OK});return false}},file_queue_error_handler:function(a,c,b){switch(c){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:d("上传文件列表数量超限,不能选择！");break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:d("文件大小超过限制, 不能选择！");break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:d("该文件大小为0,不能选择！");break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:d("该文件类型不允许上传！");break}function d(e){Ext.Msg.show({title:"提示",msg:e,icon:Ext.Msg.WARNING,buttons:Ext.Msg.OK})}},swfupload_load_failed_handler:function(){Ext.Msg.show({title:"提示",msg:"SWFUpload加载失败！",icon:Ext.Msg.ERROR,buttons:Ext.Msg.OK})},upload_start_handler:function(a){var b=this.settings.custom_settings.scope_handler;b.down("#cancelBtn").setDisabled(false);var c=b.store.getById(a.id);this.setFilePostName(encodeURIComponent(c.get("fileName")))},upload_progress_handler:function(a,e,d){var c=this.settings.custom_settings.scope_handler;var b=Math.ceil((e/d)*100);b=b==100?99:b;var f=c.store.getById(a.id);f.set("percent",b);f.set("status",a.filestatus);f.commit()},upload_error_handler:function(a,d,c){var b=this.settings.custom_settings.scope_handler;var e=b.store.getById(a.id);e.set("percent",0);e.set("status",a.filestatus);e.commit()},upload_success_handler:function(b,a,c){var d=this.settings.custom_settings.scope_handler;var e=d.store.getById(b.id);if(Ext.JSON.decode(a).success){e.set("percent",100);e.set("status",b.filestatus)}else{e.set("percent",0);e.set("status",SWFUpload.FILE_STATUS.ERROR)}e.commit();if(this.getStats().files_queued>0&&this.uploadStopped==false){this.startUpload()}else{d.showBtn(d,true)}},upload_complete_handler:function(a){},file_queued_handler:function(a){var b=this.settings.custom_settings.scope_handler;b.store.add({id:a.id,name:a.name,fileName:a.name,size:a.size,type:a.type,status:a.filestatus,percent:0})},onUpload:function(){if(this.swfupload&&this.store.getCount()>0){if(this.swfupload.getStats().files_queued>0){this.showBtn(this,false);this.swfupload.uploadStopped=false;this.swfupload.startUpload()}}},showBtn:function(a,b){a.down("#addFileBtn").setDisabled(!b);a.down("#uploadBtn").setDisabled(!b);a.down("#removeBtn").setDisabled(!b);a.down("#cancelBtn").setDisabled(b);if(b){a.down("actioncolumn").show()}else{a.down("actioncolumn").hide()}},onRemove:function(){var d=this.store;for(var b=0;b<d.getCount();b++){var a=d.getAt(b);var c=a.get("id");this.swfupload.cancelUpload(c,false)}d.removeAll();this.swfupload.uploadStopped=false},onCancelUpload:function(){if(this.swfupload){this.swfupload.uploadStopped=true;this.swfupload.stopUpload();this.showBtn(this,true)}}});Ext.define("wys.button.UploadFile",{extend:"Ext.button.Button",xtype:"uploadFileBtn",iconCls:"fa fa-upload fa-lw",text:"文件上传",ui:"button-commonToolbarBtn-toolbar",tooltip:'<span style="font-size:12px">点击进行文件上传</span>',alias:"widget.uploadFileBtn",requires:["wys.ux.FileUpload"],listeners:{click:function(){var a=this;Ext.applyIf(a.config.uploader,{browse_button:a.config.id||a.getId()});a.uploader=a.createUploader();a.uploader.initialize();a.relayEvents(a.uploader,["beforestart","uploadready","uploadstarted","uploadcomplete","uploaderror","filesadded","beforeupload","fileuploaded","updateprogress","uploadprogress","storeempty"])}},createUploader:function(){return Ext.create("wys.ux.FileUpload",this,Ext.applyIf({listeners:{}},this.initialConfig))}});Ext.define("wys.combobox.ArrayCombobox",{extend:"Ext.form.ComboBox",requires:["Ext.form.ComboBox","Ext.data.ArrayStore"],alias:"widget.ArrayCombobox",arrayData:[],cmbFields:["key","value"],displayField:"key",emptyText:"请选择...",valueField:"value",isAll:false,listeners:{expand:function(b,a){if(this.isAll){b.getStore().insert(0,new Ext.data.Record({key:"全部",value:""}))}},collapse:function(b,a){if(this.isAll){b.getStore().removeAt(0)}}},initComponent:function(){this.displayField=this.displayField,this.valueField=this.valueField,this.editable=false,this.listConfig={minWidth:160,emptyText:WY.local.lang.common.system_msg.notFoundData};this.queryMode="local",this.store=Ext.create("Ext.data.ArrayStore",{fields:this.cmbFields,data:this.arrayData});this.callParent(arguments)},setArrayData:function(b){var a=this.getStore();a.loadData(b)}},function(){});Ext.define("wys.combobox.RemoteCombobox",{extend:"Ext.form.ComboBox",requires:["Ext.form.ComboBox","Ext.data.Store"],alias:"widget.RemoteCombobox",fieldLabel:"",name:"",model:"",valueField:"",displayField:"",proxy_url:"",proxy_reader_root:"",storeListeners:{},emptyText:"请选择...",isAll:false,loadMasRecord:false,listeners:{expand:function(b,a){if(this.isAll){b.getStore().insert(0,new Ext.data.Record({key:"全部",value:""}))}},collapse:function(b,a){if(this.isAll){b.getStore().removeAt(0)}}},initComponent:function(){this.emptyText=this.emptyText||"请选择";this.valueField=this.valueField;this.displayField=this.displayField;this.triggerAction="all";this.lazyRender=true;this.name=this.name;this.listConfig={minWidth:160,emptyText:WY.local.lang.common.system_msg.notFoundData};this.queryMode="local";this.editable=false;this.fieldLabel=this.fieldLabel;this.rootVisible=false;this.params={};if(this.loadMasRecord){this.params.limit=9999}this.store=Ext.create("Ext.data.Store",{autoLoad:true,model:this.model,proxy:{type:"ajax",url:this.proxy_url,extraParams:this.params,reader:{type:"json",rootProperty:this.proxy_reader_root}}});this.callParent()}},function(){});Ext.define("wys.form.HtmlEditor.Plugins",{extend:"Ext.form.field.TextArea",alias:"widget.myHtmlEditor",constructor:function(){this.callParent(arguments);Ext.Logger.info("初始化WORD文本转换器");app.pasterMgr=new WordPasterManager();app.pasterMgr.Load();Ext.Logger.info("初始化WORD文本转换器结束");Ext.Logger.info("初始化C-LODOP打印控件");app.LODOP=getLodop(document.getElementById("SynCardOcx1"));Ext.Logger.info("初始化C-LODOP打印控件完成,"+app.LODOP)},editor:null,border:0,bodyBorder:0,style:"border-width:0px;",initComponent:function(){this.callParent(arguments);this.on("render",function(){Ext.apply(this.CKConfig,{height:this.getHeight(),width:this.getWidth(),title:this.title,baseFloatZIndex:999999,toolbarCanCollapse:true});this.editor=CKEDITOR.replace(this.inputEl.id,this.CKConfig);this.editor.title=this.title;this.editor.border=false;this.editor.name=this.name;this.editor.setData(this.value);this.editor.config.height=parseInt(this.getHeight());this.editor.on("instanceReady",function(){this.fireEvent("instanceReady",this,this.editor);app.pasterMgr.SetEditor(this.editor)},this)},this)},onRender:function(b,a){if(!this.el){this.defaultAutoCreate={tag:"textarea",autocomplete:"off"}}this.callParent(arguments)},setValue:function(b){var a=this;if(this.editor){this.editor.setData(b)}this.callParent(arguments)},getRawValue:function(){if(this.editor){return this.editor.getData()}else{return""}},getValue:function(){return this.getRawValue()}});Ext.define("wys.form.MyKeyBoard",{extend:"Ext.menu.Menu",requires:["Ext.menu.Menu","Ext.container.Container"],xtype:"keyBoardPicker",alias:"widget.keyBoardPicker",wander:true,upperCase:false,showEvents:"focus",boxMinWidth:328,boxMaxWidth:328,height:103,margin:"23 0 0 0",plain:true,autoHide:false,chars:{"`":"`","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",",":"<",".":">","/":"?",";":":","'":'"',"[":"{","]":"}","\\":"|","←":"←",Shift:"Shift","大写锁定":"大写锁定","清空":"清空"},posC:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],posN:["0","1","2","3","4","5","6","7","8","9"],initComponent:function(a){a=this.fieldWidget;if(!Ext.isIE){this.autoWidth=true}btns=Ext.create("Ext.container.Container",{ref:"kbPanel",width:Ext.isIE?318:320,height:103,style:"margin : -2px;",layout:"absolute",defaults:{width:20},defaultType:"button",items:[{text:"1",x:2,y:3},{text:"2",x:25,y:3},{text:"3",x:48,y:3},{text:"4",x:71,y:3},{text:"5",x:94,y:3},{text:"6",x:117,y:3},{text:"7",x:140,y:3},{text:"8",x:163,y:3},{text:"9",x:186,y:3},{text:"0",x:209,y:3},{text:"←",width:40,x:278,y:3},{text:"Shift",ref:"kbShift",enableToggle:true,width:63,x:2,y:53},{text:"大写锁定",ref:"kbCapsLock",enableToggle:true,width:66,x:2,y:28},{text:"a",x:69,y:28},{text:"c",x:114,y:28},{text:"b",x:91,y:28},{text:"d",x:137,y:28},{text:"e",x:160,y:28},{text:"g",x:206,y:28},{text:"f",x:183,y:28},{text:"i",x:252,y:28},{text:"j",x:275,y:28},{text:"h",x:229,y:28},{text:"k",x:298,y:28},{text:"l",x:68,y:53},{text:"p",x:160,y:53},{text:"m",x:91,y:53},{text:"n",x:114,y:53},{text:"o",x:137,y:53},{text:"r",x:206,y:53},{text:"s",x:229,y:53},{text:"t",x:252,y:53},{text:"q",x:183,y:53},{text:"u",x:275,y:53},{text:"v",x:298,y:53},{text:"w",x:68,y:78},{text:"x",x:46,y:78},{text:"z",x:114,y:78},{text:"y",x:91,y:78},{text:"清空",ref:"kbClear",width:42,x:2,y:78},{text:"=",x:255,y:3},{text:"-",x:232,y:3},{text:"`",x:137,y:78},{text:"[",x:252,y:78},{text:"]",x:275,y:78},{text:";",x:160,y:78},{text:"'",x:183,y:78},{text:",",x:206,y:78},{text:".",x:229,y:78},{text:"/",x:298,y:78}]});Ext.apply(this,{items:btns});this.doHandlers(this,a);this.addManagedListener(this,"show",this.doWander,this);this.callParent(arguments)},doHandlers:function(c,b){var a=this;Ext.Array.each(c.items.items.items,function(d){d.on("click",function(e){switch(e.text){case"大写锁定":a.doCapsLock(e);break;case"Shift":a.doShift(e);break;case"清空":a.doClear(b);break;case"←":a.doBackspace(b);break;default:a.doClicked(e,b)}},this)});c.on(this.showEvents,function(){var h=b.getPosition();var f=document.body.scrollWidth;var d=document.body.scrollHeight;var g=[];if((f-h[0]-b.getWidth()-328)>=0){g.push(h[0]+b.getWidth());g.push(h[1])}else{if((f-h[0]-328)>=0){g.push(h[0]);var e=d-h[1]-b.getHeight()-103;g.push(e>=0?(h[1]+this.getHeight()):(h[1]-103))}else{if((f-h[0]-328)<0){g.push(h[0]-328);var e=d-h[1]-b.getHeight()-103;g.push(e>=0?(h[1]+this.getHeight()):(h[1]-103))}else{g=[h[0],h[1]+b.getHeight()]}}}this.showAt(g)},this)},doBackspace:function(c){var b=c.getValue();var a=b.substring(0,b.length-1);c.setValue(a)},doClicked:function(b,a){a.setValue(a.getValue()+b.text)},doClear:function(a){a.setValue("")},doShift:function(d){var a=this;var c=d.pressed;var b=/^[a-z]{1}$/i;Ext.Array.each(this.items.items[0].items.items,function(h){var f=h.text;var e=f.charCodeAt(0);if(f.match(b)){h.setText(c?f.toUpperCase():f.toLowerCase())}else{var g=a.chars[f];h.setText(g);a.chars[g]=f}})},doCapsLock:function(c){var b=c.pressed;var a=/^[a-zA-Z]{1}$/;Ext.Array.each(this.items.items[0].items.items,function(e){console.log(e);var d=e.text;if(d.match(a)){e.setText(b?d.toUpperCase():d.toLowerCase())}})},doWander:function(){if(!this.wander){return}var d=/^[a-zA-Z]{1}$/;var c=/^\d+$/;var b=this.posC;var a=this.posN;Ext.Array.each(this.items.items.items,function(g){var i;var h=g;if((h.text.length==1)&&h.text.match(d)){var f=window.util.randomNum(0,this.posC.length-1);h.setText(this.posC[f]);this.posC=window.util.arrayDelte(this.posC,f)}else{if(h.text.match(c)){var e=window.util.randomNum(0,this.posN.length-1);h.setText(this.posN[e]);this.posN=window.util.arrayDelte(this.posN,e)}}});this.posC=b;this.posN=a},getPType:function(){return this.ptype}});Ext.define("wys.form.field.CityDataModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.cityDataModel",data:{},stores:{pickerCities:{autoLoad:true,data:[{province:653200,city:653201,provinceText:"和田地区",cityText:"和田市"},{province:653200,city:653221,provinceText:"和田地区",cityText:"和田县"},{province:653200,city:653222,provinceText:"和田地区",cityText:"墨玉县"},{province:653200,city:653223,provinceText:"和田地区",cityText:"皮山县"},{province:653200,city:653224,provinceText:"和田地区",cityText:"洛浦县"},{province:653200,city:653225,provinceText:"和田地区",cityText:"策勒县"},{province:653200,city:653226,provinceText:"和田地区",cityText:"于田县"},{province:653200,city:653227,provinceText:"和田地区",cityText:"民丰县"}]}}});Ext.define("wys.form.field.CityForm",{extend:"Ext.view.BoundList",xtype:"cityForm",cls:"citypickerwindow",currentDataType:"province",storeOriginal:null,statics:{province:{"A~G":[{province:"654300",provinceText:"阿勒泰地区"},{province:"652900",provinceText:"阿克苏地区"},{province:"652300",provinceText:"昌吉回族自治州"},{province:"652800",provinceText:"巴音郭楞蒙古自治州"},{province:"652700",provinceText:"博尔塔拉蒙古自治州"}],"H~M":[{province:"653200",provinceText:"和田地区"},{province:"650500",provinceText:"哈密市"},{province:"653000",provinceText:" 克孜勒苏柯尔克孜自治州"},{province:"653100",provinceText:"喀什地区"}],"N~S":[{province:"654200",provinceText:"塔城地区"}],"T~Z":[{province:"650100",provinceText:"乌鲁木齐市"},{province:"650200",provinceText:"克拉玛依市"},{province:"654000",provinceText:"伊犁哈萨克自治州"},{province:"650400",provinceText:"吐鲁番市"},{province:"659000",provinceText:"自治区直辖县级行政区划"}]}},provinceData:null,initComponent:function(){var a=this;a.renderTpl=['<div id="{id}-listWrap" data-ref="listWrap"',' class="{baseCls}-list-ct ',Ext.dom.Element.unselectableCls,'">','<table id="{id}-listEl" data-ref="listEl" class="',Ext.baseCSSPrefix,'list-plain" style="width:'+a.width+'px;"','<tpl foreach="ariaAttributes"> {$}="{.}"</tpl>',">","</table>","</div>","{%","var pagingToolbar=values.$comp.pagingToolbar;","if (pagingToolbar) {","Ext.DomHelper.generateMarkup(pagingToolbar.getRenderTree(), out);","}","%}",{disableFormats:true}],a.tpl=['<tr><td colspan="2"><div class="provinceIndicator active" style="width:'+a.width*0.49+'px;">省份</div><div class="cityIndicator"  style="width:'+a.width*0.49+'px;">城市</div></td></tr>','<tpl for=".">',"{html}","</tpl>"];a.store={type:"store",autoLoad:true,sortOnLoad:false,field:["id","value","isProvince","province","provinceText"]};a.callParent(arguments)},onItemClick:function(g){var j=this,l=j.pickerField,k=j.getSelectionModel();if(j.currentDataType=="city"){j.currentDataType="province";if(g.get("isProvince")!==true){l.collapse();l.setValue(g.get("id"));var f=g;f.set("city",g.get("id"));f.set("cityText",g.get("value"));l.fireEvent("select",l,f)}j.store.loadData(j.provinceData);Ext.get(Ext.query("*[class*=provinceIndicator]")[0]).setCls("provinceIndicator active");Ext.get(Ext.query("*[class*=cityIndicator]")[0]).setCls("cityIndicator")}else{j.currentDataType="city";var b=g.get("id"),m=g.get("value"),a=j.storeOriginal,c=[{isProvince:true,id:b,value:m}];a.clearFilter();a.each(function(i){if(i.get("province")==b){c.push({isProvince:false,id:i.get("city"),value:i.get("cityText"),province:i.get("province"),provinceText:i.get("provinceText")})}});var h=c.length;for(var d=0;d<h;d++){var e="";if(d==0){e+="<tr><td>";e+='<span class="x-boundlist-item" style="font-weight:bold;color:#54a1f3;">'+c[d].value+"</span>"}else{e+='<span class="x-boundlist-item"  style="display:inline-block;">'+c[d].value+"</span>"}if((d+1)==h){e+="</td></tr>"}c[d].html=e}j.store.loadData(c);Ext.get(Ext.query("*[class*=provinceIndicator]")[0]).setCls("provinceIndicator");Ext.get(Ext.query("*[class*=cityIndicator]")[0]).setCls("cityIndicator active")}if(k){k.deselectAll()}},initData:function(b){var f=this;f.storeOriginal=b,proviceOriginal=wys.form.field.CityForm.province,proviceList={};f.currentDataType="province";f.storeOriginal.clearFilter();for(var e in proviceOriginal){Ext.each(proviceOriginal[e],function(i){b.each(function(j){if(j.get("province")==i.province){var k=proviceList[e];if(!k){k=proviceList[e]=[]}k.push({isProvince:true,id:j.get("province"),value:j.get("provinceText")});return false}})})}var g=[];for(var e in proviceList){var h=proviceList[e],a=h.length;if(a==0){continue}var d="";for(var c=0;c<a;c++){d="";if(c==0){d+='<tr><td width="60">'+e+"</td><td>"}d+='<span class="x-boundlist-item">'+h[c].value+"</span>";if((c+1)==a){d+="</td></tr>"}g.push(Ext.apply({html:d},h[c]))}}f.provinceData=g;f.store.loadData(g)}});Ext.define("wys.form.field.CityPicker",{extend:"Ext.form.field.Picker",xtype:"cityPicker",alias:"widget.cityPicker",requires:["Ext.view.BoundList","wys.form.field.CityDataModel","wys.form.field.CityForm","Ext.util.DelayedTask","Ext.data.StoreManager"],mixins:["Ext.util.StoreHolder"],viewModel:"cityDataModel",bind:{store:"{pickerCities}",readOnly:"{readOnly}"},comboPicker:null,formPicker:null,config:{filters:null,selection:null,valueNotFoundText:null,displayTpl:false,delimiter:", ",displayField:"displayName"},publishes:["selection"],twoWayBindable:["selection"],triggerCls:Ext.baseCSSPrefix+"form-arrow-trigger",hiddenName:"",collapseOnSelect:false,hiddenDataCls:Ext.baseCSSPrefix+"hidden-display "+Ext.baseCSSPrefix+"form-data-hidden",ariaRole:"combobox",childEls:{hiddenDataEl:true},filtered:false,afterRender:function(){var a=this;a.callParent(arguments);a.setHiddenValue(a.value)},multiSelect:false,valueField:"city",displayField:"cityText",queryMode:"local",allowBlank:false,allQuery:"",queryParam:"query",queryCaching:true,autoLoadOnValue:false,pageSize:0,autoSelect:true,typeAhead:false,typeAheadDelay:250,selectOnTab:true,forceSelection:false,growToLongestValue:true,clearFilterOnBlur:true,hideTrigger:true,defaultListConfig:{loadingHeight:70,minWidth:70,maxHeight:500,shadow:"sides"},matchFieldWidth:false,listConfig:{minWidth:300,maxHeight:600},transformInPlace:true,clearValueOnEmpty:true,getGrowWidth:function(){var d=this,f=d.inputEl.dom.value,e,g,h,c,b,j,a;if(d.growToLongestValue){e=d.displayField;g=d.store;h=g.data.length;c=0;for(b=0;b<h;b++){j=g.getAt(b).data[e];a=j.length;if(a>c){c=a;f=j}}}return f},initComponent:function(){var e=this,c=Ext.isDefined,b=e.store,d=e.transform,a,f;if("pinList" in e){e.collapseOnSelect=!e.pinList}if(d){a=Ext.getDom(d);if(a){if(!e.store){b=Ext.Array.map(Ext.Array.from(a.options),function(g){return[g.value,g.text]})}if(!e.name){e.name=a.name}if(!("value" in e)){e.value=a.value}}}e.bindStore(b||"ext-empty-store",true,true);f=e.queryMode==="local";if(!c(e.queryDelay)){e.queryDelay=f?10:500}if(!c(e.minChars)){e.minChars=f?0:4}e.callParent();e.doQueryTask=new Ext.util.DelayedTask(e.doRawQuery,e);if(a){if(e.transformInPlace){e.render(a.parentNode,a);delete e.renderTo}Ext.removeNode(a)}e.on("focus",e.$onOnFocus,e);e.on("keyup",e.$onKeyup,e)},$onOnFocus:function(){var a=this;if(a.readOnly){return}if(a.formPicker){a.picker=a.formPicker;a.formPicker.initData(a.store)}a.expand();if(a.inputEl){a.inputEl.un("mousedown",a.$onMousedown,a);a.inputEl.on("mousedown",a.$onMousedown,a)}},$onMousedown:function(){var a=this;if(!a.isExpanded){if(a.formPicker){a.picker=a.formPicker;a.formPicker.initData(a.store)}a.expand()}},$onKeyup:function(){var b=this,a=b.getRawValue();if(a!=null&&a!=""){if(b.picker!=b.comboPicker){b.collapse();b.picker=b.comboPicker;b.expand()}}else{if(b.picker!=b.formPicker){b.collapse();b.picker=b.formPicker;b.formPicker.initData(b.store);this.expand()}}},getSubTplData:function(b){var c,a;c=this.callParent([b]);a=c.inputElAriaAttributes;if(a){a["aria-autocomplete"]="list"}return c},getSubTplMarkup:function(c){var d=this,a="",b=d.callParent(arguments);if(d.hiddenName){a='<div id="'+c.id+'-hiddenDataEl" data-ref="hiddenDataEl" class="'+d.hiddenDataCls+'" role="presentation"></div>'}return a+b},applyDisplayTpl:function(b){var a=this;if(!b){b=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : values["'+a.getDisplayField()+'"]]}<tpl if="xindex < xcount">'+a.getDelimiter()+"</tpl></tpl>")}else{if(!b.isTemplate){b=new Ext.XTemplate(b)}}return b},applyFilters:function(b,c){var a=this;if(b===null||b.isFilterCollection){return b}if(b){if(!c){c=this.getFilters()}c.beginUpdate();c.splice(0,c.length,b);c.each(function(d){d.ownerId=a.id});c.endUpdate()}return c},applyValueNotFoundText:function(a){var b=this,c=b.valueNotFoundRecord||(b.valueNotFoundRecord=new Ext.data.Model());c.set(b.displayField,a);if(b.valueField&&b.displayField!==b.valueField){c.set(b.valueField,a)}return a},getFilters:function(b){var a=this.filters;if(!a&&b!==false){a=new Ext.util.FilterCollection();this.setFilters(a)}return a},updateFilters:function(a,b){var c=this;if(b){b.un("endupdate","onEndUpdateFilters",c)}if(a){a.on("endupdate","onEndUpdateFilters",c)}c.onEndUpdateFilters(a)},onEndUpdateFilters:function(e){var d=this,f=d.filtered,c=!!e&&(e.length>0),a,b;if(f||c){d.filtered=c;a=[];b=d.store.getFilters();b.each(function(g){if(g.ownerId===d.id&&!e.contains(g)){a.push(g)}});b.splice(0,a,e.items)}},completeEdit:function(c){var b=this,a=b.queryFilter;this.callParent([c]);b.doQueryTask.cancel();b.assertValue();if(a&&b.queryMode==="local"&&b.clearFilterOnBlur){b.getStore().getFilters().remove(a)}},onFocus:function(b){var a=this;a.callParent([b]);if(a.triggerAction!=="all"&&a.queryFilter&&a.queryMode==="local"&&a.clearFilterOnBlur){delete a.lastQuery;a.doRawQuery()}},assertValue:function(){var b=this,c=b.getRawValue(),a=b.getDisplayValue(),d=b.lastSelectedRecords,e;if(b.forceSelection){if(b.multiSelect){if(c!==a){b.setRawValue(a)}}else{e=b.findRecordByDisplay(c);if(e){if(b.getDisplayValue([b.getRecordDisplayData(e)])!==a){b.select(e,true)}}else{if(d){b.setValue(d)}else{b.setRawValue("")}}}}b.collapse()},onTypeAhead:function(){var e=this,d=e.displayField,b=e.store.findRecord(d,e.getRawValue()),c=e.getPicker(),f,a,g;if(b){f=b.get(d);a=f.length;g=e.getRawValue().length;c.highlightItem(c.getNode(b));if(g!==0&&g!==a){e.setRawValue(f);e.selectText(g,f.length)}}},resetToDefault:Ext.emptyFn,beforeReset:function(){var a=this.queryFilter;this.callParent();if(a){this.getStore().getFilters().remove(a)}},onUnbindStore:function(){var c=this,a=c.picker,b=c.queryFilter;if(b&&!c.store.destroyed){c.changingFilters=true;c.getStore().removeFilter(b,true);c.changingFilters=false}c.pickerSelectionModel.destroy();if(a){a.bindStore(null)}},onBindStore:function(a,b){var d=this,f=d.comboPicker,c,e;if(a){if(a.autoCreated){d.queryMode="local";d.valueField=d.displayField="field1";if(!a.expanded){d.displayField="field2"}d.setDisplayTpl(null)}if(!Ext.isDefined(d.valueField)){d.valueField=d.displayField}c={byValue:{rootProperty:"data",unique:false}};c.byValue.property=d.valueField;a.setExtraKeys(c);if(d.displayField===d.valueField){a.byText=a.byValue}else{c.byText={rootProperty:"data",unique:false};c.byText.property=d.displayField;a.setExtraKeys(c)}e={rootProperty:"data",extraKeys:{byInternalId:{property:"internalId"},byValue:{property:d.valueField,rootProperty:"data"}},listeners:{beginupdate:d.onValueCollectionBeginUpdate,endupdate:d.onValueCollectionEndUpdate,scope:d}};d.valueCollection=new Ext.util.Collection(e);d.pickerSelectionModel=new Ext.selection.DataViewModel({mode:d.multiSelect?"SIMPLE":"SINGLE",deselectOnContainerClick:false,enableInitialSelection:false,pruneRemoved:false,selected:d.valueCollection,store:a,listeners:{scope:d,lastselectedchanged:d.updateBindSelection}});if(!b){d.resetToDefault()}if(f){f.setSelectionModel(d.pickerSelectionModel);if(f.getStore()!==a){f.bindStore(a)}}}},bindStore:function(a,e,b){var d=this,c=d.queryFilter;d.mixins.storeholder.bindStore.call(d,a,b);a=d.getStore();if(a&&c&&!e){a.getFilters().add(c)}if(!b&&a&&!a.isEmptyStore){d.setValueOnData()}},getStoreListeners:function(b){if(!b.isEmptyStore){var c=this,a={datachanged:c.onDataChanged,load:c.onLoad,exception:c.onException,update:c.onStoreUpdate,remove:c.checkValueOnChange};if(!b.getRemoteFilter()){a.filterchange=c.checkValueOnChange}return a}},onDataChanged:function(){if(this.grow&&this.growToLongestValue){this.autoSize()}},checkValueOnChange:function(){var a=this;if(!a.destroying&&a.getStore().isLoaded()){if(a.multiSelect){}else{if(a.forceSelection&&!a.changingFilters&&!a.findRecordByValue(a.value)){a.setValue(null)}}}},onStoreUpdate:function(b,a){this.updateValue()},onException:function(){this.collapse()},onLoad:function(c,b,e){var d=this,a=!d.valueCollection.byValue.get(d.value);if(e&&a&&!(c.lastOptions&&"rawQuery" in c.lastOptions)){d.setValueOnData()}d.checkValueOnChange()},setValueOnData:function(){var a=this;a.setValue(a.value);if(a.isExpanded&&a.getStore().getCount()){a.doAutoSelect()}},doRawQuery:function(){var a=this,b=a.inputEl.dom.value;if(a.multiSelect){b=b.split(a.delimiter).pop()}a.doQuery(b,false,true)},doQuery:function(f,c,e){var d=this,a=d.beforeQuery({query:f||"",rawQuery:e,forceAll:c,combo:d,cancel:false}),b=d.queryFilter;if(d.picker==d.formPicker){if(b){d.queryFilter=null;d.store.removeFilter(b,true)}return}if(a!==false&&!a.cancel){if(d.queryCaching&&a.query===d.lastQuery){d.expand()}else{d.lastQuery=a.query;if(d.queryMode==="local"){d.doLocalQuery(a)}else{}}}return true},beforeQuery:function(a){var b=this;if(b.fireEvent("beforequery",a)===false){a.cancel=true}else{if(!a.cancel){if(a.query.length<b.minChars&&!a.forceAll){a.cancel=true}}}return a},doLocalQuery:function(b){var d=this,e=b.query,a=d.getStore(),c=d.queryFilter;d.queryFilter=null;d.changingFilters=true;if(c){a.removeFilter(c,true)}if(e){c=d.queryFilter=new Ext.util.Filter({id:d.id+"-filter",anyMatch:d.anyMatch,caseSensitive:d.caseSensitive,root:"data",property:d.displayField,value:d.enableRegEx?new RegExp(e):e});a.addFilter(c,true)}d.changingFilters=false;if(d.store.getCount()||d.getPicker().emptyText){if(d.getPicker()&&d.getPicker().refresh){d.getPicker().refresh()}d.expand()}else{d.collapse()}d.afterQuery(b)},afterQuery:function(a){var b=this;if(b.store.getCount()){if(b.typeAhead){b.doTypeAhead()}if(a.rawQuery){if(b.picker.getSelectionModel){if(b.picker&&!b.picker.getSelectionModel().hasSelection()){b.doAutoSelect()}}}else{b.doAutoSelect()}}b.checkChange()},loadPage:function(b,a){this.store.loadPage(b,Ext.apply({params:this.getParams(this.lastQuery)},a))},onPageChange:function(b,a){this.loadPage(a);return false},getParams:function(c){var b={},a=this.queryParam;if(a){b[a]=c}return b},doAutoSelect:function(){var b=this,a=b.picker;if(a.getNavigationModel){if(a&&b.autoSelect&&b.store.getCount()>0){a.getNavigationModel().setPosition(b.picker.getSelectionModel().lastSelected||0)}}},doTypeAhead:function(){var b=this,a=Ext.event.Event;if(!b.typeAheadTask){b.typeAheadTask=new Ext.util.DelayedTask(b.onTypeAhead,b)}if(b.lastKey!==a.BACKSPACE&&b.lastKey!==a.DELETE){b.typeAheadTask.delay(b.typeAheadDelay)}},onTriggerClick:function(){var a=this;if(!a.readOnly&&!a.disabled){if(a.isExpanded){a.collapse()}else{if(a.triggerAction==="all"){a.doQuery(a.allQuery,true)}else{if(a.triggerAction==="last"){a.doQuery(a.lastQuery,true)}else{a.doQuery(a.getRawValue(),false,true)}}}}},onFieldMutation:function(g){var d=this,b=g.getKey(),c=b===g.BACKSPACE||b===g.DELETE,f=d.inputEl.dom.value,a=f.length;if(!d.readOnly&&(f!==d.lastMutatedValue||c)&&b!==g.TAB){d.lastMutatedValue=f;d.lastKey=b;if(a&&(g.type!=="keyup"||(!g.isSpecialKey()||c))){d.doQueryTask.delay(d.queryDelay)}else{if(!a&&(!b||c)){if(!d.multiSelect){d.value=null;d.displayTplData=undefined}if(d.clearValueOnEmpty){d.valueCollection.removeAll()}d.collapse();if(d.queryFilter){d.changingFilters=true;d.store.removeFilter(d.queryFilter,true);d.changingFilters=false}}d.callParent([g])}}},onDestroy:function(){var a=this;a.doQueryTask.cancel();if(a.typeAheadTask){a.typeAheadTask.cancel();a.typeAheadTask=null}a.bindStore(null);a.valueCollection=Ext.destroy(a.valueCollection);a.callParent()},onAdded:function(){var a=this;a.callParent(arguments);if(a.picker){a.picker.ownerCt=a.up("[floating]");a.picker.registerWithOwnerCt()}},dataReady:false,getPickerStore:function(){var a=this;return a.store},onBeforePickerShow:function(a){var b=this,d=b.getPosition()[1]-Ext.getBody().getScroll().top,c=Ext.Element.getViewportHeight()-d-b.getHeight();a.maxHeight=Math.max(d,c)-5},onBeforeSelect:function(c,a,b){return this.fireEvent("beforeselect",this,a,b)},onBeforeDeselect:function(c,a,b){return this.fireEvent("beforedeselect",this,a,b)},onFocusChange:function(c,a,b){var d=this.picker,e;if(b){e=Ext.get(d.getNodeByRecord(b));if(e){this.ariaEl.dom.setAttribute("aria-activedescendant",e.id)}}},getSelection:function(){var a=this.getPicker().getSelectionModel(),b=a.getSelection();return b.length?a.getLastSelected():null},updateSelection:function(a){var b=this,c;if(!b.ignoreNextSelection){b.ignoreNextSelection=true;c=b.getPicker().getSelectionModel();if(a){c.select(a);b.hasHadSelection=true}else{c.deselectAll()}b.ignoreNextSelection=false}},updateBindSelection:function(a,c){var d=this,b=null;if(!d.ignoreNextSelection){d.ignoreNextSelection=true;if(c.length){b=a.getLastSelected();d.hasHadSelection=true}if(d.hasHadSelection){d.setSelection(b)}d.ignoreNextSelection=false}},onValueCollectionBeginUpdate:Ext.emptyFn,onValueCollectionEndUpdate:function(){var d=this,c=d.store,e=d.valueCollection.getRange(),b=e[0],a=e.length;d.updateBindSelection(d.pickerSelectionModel,e);if(d.isSelectionUpdating()){return}Ext.suspendLayouts();d.lastSelection=e;if(a){d.lastSelectedRecords=e}d.updateValue();if(a&&((!d.multiSelect&&c.contains(b))||d.collapseOnSelect||!c.getCount())){d.updatingValue=true;d.collapse();d.updatingValue=false}Ext.resumeLayouts(true);if(a&&!d.suspendCheckChange){if(!d.multiSelect){e=b}d.fireEvent("select",d,e)}},isSelectionUpdating:function(){var a=this.pickerSelectionModel;return a.deselectingDuringSelect||a.refreshing},onExpand:function(){var c=this,b=c.getPicker();if(b.getNavigationModel){var a=this.getPicker().getNavigationModel();if(a){a.enable()}this.doAutoSelect()}},onCollapse:function(){var a=this.getPicker()},select:function(d,a){var c=this,b=c.picker,e;if(d&&d.isModel&&a===true&&b){e=!b.getSelectionModel().isSelected(d)}if(!e){c.suspendEvent("select")}c.setValue(d);c.resumeEvent("select")},findRecord:function(d,c){var b=this.store,a=b.findExact(d,c);return a!==-1?b.getAt(a):false},getSelectedRecord:function(){return this.findRecordByValue(this.value)||null},findRecordByValue:function(c){var a=this.store.byValue.get(c),b=false;if(a){b=a[0]||a}return b},findRecordByDisplay:function(c){var a=this.store.byText.get(c),b=false;if(a){b=a[0]||a}return b},addValue:function(a){if(a!=null){return this.doSetValue(a,true)}},setValue:function(b){var a=this;if(b!=null){return a.doSetValue(b)}else{a.suspendEvent("select");a.valueCollection.beginUpdate();a.pickerSelectionModel.deselectAll();a.valueCollection.endUpdate();a.lastSelectedRecords=null;a.resumeEvent("select")}},setRawValue:function(a){this.callParent([a]);this.lastMutatedValue=a},doSetValue:function(p,l){var v=this,g=v.getStore(),h=g.getModel(),s=[],f=[],r=v.autoLoadOnValue,e=g.getCount()>0||g.isLoaded(),a=g.hasPendingLoad(),m=r&&!e&&!a,k=v.forceSelection,o=v.pickerSelectionModel,b=v.displayField===v.valueField,n=g.isEmptyStore,j=v.lastSelection,t,u,c,q,d,w;if(a||m||!e||n){if(!p.isModel){if(l){v.value=Ext.Array.from(v.value).concat(p)}else{v.value=p}v.setHiddenValue(v.value);v.setRawValue(b?p:"")}if(m&&!n){g.load()}if(!p.isModel||n){return v}}p=l?Ext.Array.from(v.value).concat(p):Ext.Array.from(p);for(t=0,u=p.length;t<u;t++){c=p[t];if(!c||!c.isModel){c=v.findRecordByValue(w=c);if(!c){c=v.valueCollection.find(v.valueField,w)}}if(!c){if(!k){if(!c&&p[t]){q={};q[v.displayField]=p[t];if(v.valueField&&v.displayField!==v.valueField){q[v.valueField]=p[t]}c=new h(q)}}else{if(v.valueNotFoundRecord){c=v.valueNotFoundRecord}}}if(c){s.push(c);f.push(c.get(v.valueField))}}if(j){u=j.length;if(u===s.length){for(t=0;!d&&t<u;t++){if(Ext.Array.indexOf(v.lastSelection,s[t])===-1){d=true}}}else{d=true}}else{d=s.length}if(d){v.suspendEvent("select");v.valueCollection.beginUpdate();if(s.length){o.select(s,false)}else{o.deselectAll()}v.valueCollection.endUpdate();v.resumeEvent("select")}else{v.updateValue()}return v},updateValue:function(){var e=this,h=e.valueCollection.getRange(),a=h.length,d=[],f=e.displayTplData||(e.displayTplData=[]),g=e.inputEl,c,b;f.length=0;for(c=0;c<a;c++){b=h[c];f.push(e.getRecordDisplayData(b));if(b!==e.valueNotFoundRecord){d.push(b.get(e.valueField))}}e.setHiddenValue(d);e.value=e.multiSelect?d:d[0];if(!Ext.isDefined(e.value)){e.value=undefined}e.displayTplData=f;if(g&&e.emptyText&&!Ext.isEmpty(e.value)){g.removeCls(e.emptyCls)}e.setRawValue(e.getDisplayValue());e.checkChange();e.applyEmptyText()},setHiddenValue:function(h){var e=this,a=e.hiddenName,d,b,j,g,f,c;if(!e.hiddenDataEl||!a){return}h=Ext.Array.from(h);b=e.hiddenDataEl.dom;j=b.childNodes;g=j[0];f=h.length;c=j.length;if(!g&&f>0){e.hiddenDataEl.setHtml(Ext.DomHelper.markup({tag:"input",type:"hidden",name:a}));c=1;g=b.firstChild}while(c>f){b.removeChild(j[0]);--c}while(c<f){b.appendChild(g.cloneNode(true));++c}for(d=0;d<f;d++){j[d].value=h[d]}},getDisplayValue:function(a){a=a||this.displayTplData;return this.getDisplayTpl().apply(a)},getRecordDisplayData:function(a){return a.data},getValue:function(){var c=this,a=c.getStore(),b=c.picker,e=c.getRawValue(),d=c.value;if(!a.isEmptyStore&&c.getDisplayValue()!==e){c.displayTplData=undefined;if(b){c.valueCollection.suspendEvents();b.getSelectionModel().deselectAll();c.valueCollection.resumeEvents();c.lastSelection=null}if(a.isLoaded()&&(c.multiSelect||c.forceSelection)){d=c.value=undefined}else{d=c.value=e}}c.value=d==null?null:d;return c.value},getSubmitValue:function(){var a=this.getValue();if(Ext.isEmpty(a)){a=""}return a},isEqual:function(e,d){var b=Ext.Array.from,c,a;e=b(e);d=b(d);a=e.length;if(a!==d.length){return false}for(c=0;c<a;c++){if(d[c]!==e[c]){return false}}return true},clearValue:function(){this.setValue(null)},width:"100%",enableKeyEvents:true,queryMode:"local",anyMatch:true,caseSensitive:true,valueField:"valueName",emptyText:"请选择城市名称",tpl:Ext.create("Ext.XTemplate",'<ul class="x-list-plain"><tpl for=".">','<li role="option" class="x-boundlist-item">{provinceText} {cityText}</li>',"</tpl></ul>"),displayTpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"{provinceText} {cityText}","</tpl>"),refreshCityForm:function(){var a=this;if(!a.formPicker){return}a.formPicker.initData(a.store)},createPicker:function(){var a=this,b=a.comboPicker,c=a.formPicker;if(!b){b=a.comboPicker=a.createComboPicker();delete a.createComboPicker}if(!c){c=a.formPicker=a.createFormPicker();delete a.createFormPicker}return c},createFormPicker:function(){var c=this,b,a=Ext.apply({xtype:"cityForm",width:c.width-10,height:200,store:c.getPickerStore(),pickerField:c,floating:true,hidden:true},c.listConfig,c.defaultListConfig);b=c.formPicker=Ext.widget(a);b.initData(c.store);if(!b.initialConfig.maxHeight){b.on({beforeshow:c.onBeforePickerShow,scope:c})}return b},createComboPicker:function(){var c=this,b,a=Ext.apply({xtype:"boundlist",id:c.pickerId,pickerField:c,emptyText:"<span style='color:red'>城市不存在或暂未开通服务</span>",selectionModel:c.pickerSelectionModel,floating:true,hidden:true,store:c.getPickerStore(),displayField:c.displayField,preserveScrollOnRefresh:true,pageSize:c.pageSize,tpl:c.tpl},c.listConfig,c.defaultListConfig);b=c.comboPicker=Ext.widget(a);if(c.pageSize){b.pagingToolbar.on("beforechange",c.onPageChange,c)}if(!b.initialConfig.maxHeight){b.on({beforeshow:c.onBeforePickerShow,scope:c})}b.getSelectionModel().on({beforeselect:c.onBeforeSelect,beforedeselect:c.onBeforeDeselect,focuschange:c.onFocusChange,scope:c});b.getNavigationModel().navigateOnSpace=false;return b},beforeDestroy:function(){var a=this,b=a.comboPicker,c=a.formPicker;a.callParent();if(b){a.comboPicker=b.pickerField=null}if(c){a.formPicker=c.pickerField=null}}});Ext.define("wys.form.field.CodeEditorField",{extend:"Ext.form.field.Text",alias:"widget.codeEditorField",requires:["Ext.form.trigger.Component"],emptyText:"请输入",type:"text/javascript",triggers:{clear:{weight:0,cls:Ext.baseCSSPrefix+"form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},search:{weight:1,cls:Ext.baseCSSPrefix+"fa fa-code fa-lg",handler:"onDotClick",scope:"this"}},hasSearch:false,paramName:"query",initComponent:function(){var a=this;a.callParent(arguments)},onClearClick:function(){var a=this;a.setValue("");a.getTrigger("clear").hide()},onDotClick:function(){var a=this,b=a.getValue();a.getTrigger("clear").show();Ext.create("Ext.window.Window",{autoShow:true,title:"添加代码",iconCls:"fa fa-code fa-lg",requires:["Ext.window.Window"],modal:true,maximizable:true,closeAction:"hide",layout:"fit",autoScroll:true,animCollapse:true,animateTarget:Ext.getBody(),border:true,style:"border-color: #b6babe;",closeToolText:"点击关闭窗口",width:Ext.getBody().getSize().width-100,height:Ext.getBody().getSize().height-100,listeners:{show:function(d){var c=CodeMirror.fromTextArea(Ext.getDom(d.down("textarea").id+"-inputEl"),{lineNumbers:true,indentUnit:4,styleActiveLine:true,matchBrackets:true,mode:a.type,lineWrapping:true,theme:"vibrant-ink"});c.setSize("auto",Ext.getCmp(d.down("textarea").id).getHeight()-3+"px")},close:function(c){c.down("textarea").setValue("")}},items:[{xtype:"textarea"}]}).show()}});Ext.define("wys.form.field.ColorsField",{extend:"Ext.form.field.Trigger",alias:"widget.colorsField",requires:["Ext.picker.Color"],triggerTip:"请选择一个颜色",onTriggerClick:function(){var b=this;if(!b.picker){b.picker=Ext.create("Ext.picker.Color",{pickerField:this,ownerCt:this,renderTo:Ext.getBody(),floating:true,editable:false,focusOnShow:true,style:{backgroundColor:"#fff"},listeners:{scope:this,select:function(e,d,c){b.setValue("#"+d);b.inputEl.applyStyles({backgroundColor:"#"+d});b.picker.hide()}}});b.picker.alignTo(b.inputEl,"tl-bl?")}b.picker.show();var a=b.attached||false;b.lastShow=new Date();if(!a){Ext.getDoc().on("mousedown",b.onMouseDown,b,{buffer:Ext.isIE9m?10:undefined});b.attached=true}},onMouseDown:function(c){var a=this.lastShow,b=true;if(Ext.Date.getElapsed(a)>50&&!c.getTarget("#"+this.picker.id)){if(Ext.isIE9m&&!Ext.getDoc().contains(c.target)){b=false}if(b){this.picker.hide();Ext.getDoc().un("mousedown",this.onMouseDown,this);this.attached=false}}}});Ext.define("wys.form.field.FontField",{extend:"Ext.form.field.Text",alias:"widget.fontField",requires:["Ext.form.trigger.Component"],style:"background-color: #fff;",width:"100%",emptyText:"12",triggers:{clear:{weight:0,cls:Ext.baseCSSPrefix+"form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},blod:{weight:1,cls:Ext.baseCSSPrefix+"fa fa fa-bold",handler:"fontBold",scope:"this"}},initComponent:function(){var a=this;a.callParent(arguments)},onClearClick:function(){var a=this;a.setValue("")},fontBold:function(){var a=this,b=a.getValue()},fontItalic:function(){},fontColor:function(){}});Ext.define("wys.form.field.LetterField",{extend:"Ext.form.field.Text",alias:"widget.letterField",requires:["Ext.form.trigger.Component","wys.form.MyKeyBoard"],emptyText:"请输入字母字符",enableKeyEvents:true,isUpCase:false,triggers:{clear:{weight:0,cls:Ext.baseCSSPrefix+"form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},search:{weight:1,cls:Ext.baseCSSPrefix+"fa fa-keyboard-o fa-lg",handler:"onKeyBoardClick",scope:"this"}},initComponent:function(){var a=this;Ext.apply(a,{listeners:{change:function(b,d,c){if(a.isUpCase){b.setValue(b.getValue().toUpperCase())}else{b.setValue(b.getValue().toLowerCase())}}}});a.callParent(arguments)},onClearClick:function(){var a=this;a.setValue("")},onKeyBoardClick:function(){var a=this,b=a.getValue();Ext.create("wys.form.MyKeyBoard",{renderTo:Ext.getBody(),width:328,height:138,upperCase:a.isUpCase,fieldWidget:this,style:"z-index:999999"}).showAt(a.getXY())}});Ext.define("wys.form.field.SearchCombo",{extend:"Ext.form.field.ComboBox",requiers:["Ext.grid.Panel"],alternateClassName:"Ext.form.SearchComboBox",alias:["widget.searchComboBox","widget.searchCombo"],createPicker:function(){var b=this;var a=Ext.create("Ext.grid.Panel",{store:b.store,frame:true,autoWidth:true,resizable:true,columns:[{text:"名称",minWidth:b.getWidth(),flex:1,dataIndex:b.displayField}],floating:true,hidden:true,autoScroll:true,maxHeight:400,viewConfig:{emptyText:'<div style="text-align:center">没有找到相关记录<div>'},focusOnToFront:false});b.mon(a,{itemclick:b.onItemClick,refresh:function(){},scope:b});b.mon(a.getSelectionModel(),{beforeselect:function(c){},beforedeselect:function(c){},selectionchange:b.onListSelectionChange,scope:b});a.addDocked({xtype:"toolbar",items:[{text:"13131",xtype:"button"}],dock:"top"});this.picker=a;return a},onItemClick:function(c,a){var e=this,d=e.picker.getSelectionModel().getSelection(),b=e.valueField;if(!e.multiSelect&&d.length){a.get(b),d[0].get(b);if(a.get(b)===d[0].get(b)){e.displayTplData=[a.data];e.setRawValue(e.getDisplayValue());e.collapse()}}else{}},matchFieldWidth:false,onListSelectionChange:function(b,d){var a=this,e=a.multiSelect,c=d.length>0;if(!a.ignoreSelection&&a.isExpanded){if(!e){Ext.defer(a.collapse,1,a)}if(e||c){a.setValue(d,false)}if(c){a.fireEvent("select",a,d)}}},doAutoSelect:function(){var e=this,d=e.picker,f,g;if(d&&e.autoSelect&&e.store.getCount()>0){f=d.getSelectionModel().lastSelected;g=d.view.getNode(f||0);var b=[];if(!Ext.isEmpty(e.getValue())){for(var c=0;c<e.getValue().length;c++){var a=e.store.findRecord("bizCode",e.getValue()[c]);b.push(a)}}if(g){d.view.highlightItem(g);d.view.el.scrollChildIntoView(g,false)}}},onChange:function(f,e,i,h){var g=this;g.setValue(f)}});Ext.define("wys.form.field.SpecialName",{extend:"Ext.form.field.Text",alias:"widget.specialNameField",requires:["Ext.form.trigger.Component"],emptyText:"请输入您的名称",vtype:"checkName",triggers:{clear:{weight:0,cls:Ext.baseCSSPrefix+"form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},search:{weight:1,cls:"fa fa-dot-circle-o fa-lg",handler:"onDotClick",scope:"this"}},hasSearch:false,paramName:"query",initComponent:function(){var a=this;a.callParent(arguments)},onClearClick:function(){var a=this;a.setValue("");a.getTrigger("clear").hide()},onDotClick:function(){var a=this,b=a.getValue();a.setValue(b+"·");a.getTrigger("clear").show()}});Ext.define("wys.form.field.date.DateTime",{extend:"Ext.Component",requires:["Ext.XTemplate","Ext.button.Button","Ext.button.Split","Ext.util.ClickRepeater","Ext.util.KeyNav","Ext.fx.Manager","Ext.picker.Month","Ext.form.field.Number"],alias:"widget.datetimepicker",todayText:"今天",ariaTitle:"{0}",ariaTitleDateFormat:"Y年m月d日",todayTip:"{0} (空格键选择)",minText:"日期必须大于最小允许日期",ariaMinText:"日期必须大于最小允许日期",maxText:"日期必须小于最大允许日期",ariaMaxText:"日期必须小于最大允许日期",disabledDaysText:"",ariaDisabledDaysText:"",disabledDatesText:"",ariaDisabledDatesText:"",nextText:"下个月 (Ctrl+Right)",prevText:"上个月 (Ctrl+Left)",monthYearText:"选择一个月 (Control+Up/Down 来改变年份)",monthYearFormat:"Y年m月",startDay:0,showToday:true,disableAnim:false,baseCls:Ext.baseCSSPrefix+"datepicker",longDayFormat:"Y年m月d日",footerButtonUI:"default",isDatePicker:true,alignOnScroll:false,ariaRole:"region",focusable:true,childEls:["innerEl","eventEl","prevEl","nextEl","middleBtnEl","footerEl"],border:true,renderTpl:['<div id="{id}-innerEl" data-ref="innerEl" role="presentation">','<div class="{baseCls}-header">','<div id="{id}-prevEl" data-ref="prevEl" class="{baseCls}-prev {baseCls}-arrow" role="presentation" title="{prevText}"></div>','<div id="{id}-middleBtnEl" data-ref="middleBtnEl" class="{baseCls}-month" role="heading">{%this.renderMonthBtn(values, out)%}</div>','<div id="{id}-nextEl" data-ref="nextEl" class="{baseCls}-next {baseCls}-arrow" role="presentation" title="{nextText}"></div>',"</div>",'<table role="grid" id="{id}-eventEl" data-ref="eventEl" class="{baseCls}-inner" cellspacing="0" tabindex="0" aria-readonly="true">',"<thead>",'<tr role="row">','<tpl for="dayNames">','<th role="columnheader" class="{parent.baseCls}-column-header" aria-label="{.}">','<div role="presentation" class="{parent.baseCls}-column-header-inner">{.:this.firstInitial}</div>',"</th>","</tpl>","</tr>","</thead>","<tbody>",'<tr role="row">','<tpl for="days">',"{#:this.isEndOfWeek}",'<td role="gridcell">','<div hidefocus="on" class="{parent.baseCls}-date"></div>',"</td>","</tpl>","</tr>","</tbody>","</table>",'<table role="grid" class="{baseCls}-footer" role="presentation" cellspacing="0" tabindex="0">',"<tr>",'<td style="width:102px;padding:5px">{%this.renderHourField(values, out)%}</td>','<td style="width:102px;padding:6px">{%this.renderMinuteField(values, out)%}</td>','<td style="width:102px;padding:5px">{%this.renderSecondField(values, out)%}</td>',"</tr>","</table>",'<tpl if="showToday">','<div id="{id}-footerEl" data-ref="footerEl" role="presentation" class="{baseCls}-footer">{%this.renderTodayBtn(values, out)%}</div>',"</tpl>",'<div id="{id}-todayText" class="'+Ext.baseCSSPrefix+'hidden-clip">{todayText}.</div>','<div id="{id}-ariaMinText" class="'+Ext.baseCSSPrefix+'hidden-clip">{ariaMinText}.</div>','<div id="{id}-ariaMaxText" class="'+Ext.baseCSSPrefix+'hidden-clip">{ariaMaxText}.</div>','<div id="{id}-ariaDisabledDaysText" class="'+Ext.baseCSSPrefix+'hidden-clip">{ariaDisabledDaysText}.</div>','<div id="{id}-ariaDisabledDatesText" class="'+Ext.baseCSSPrefix+'hidden-clip">{ariaDisabledDatesText}.</div>',"</div>",{firstInitial:function(a){return Ext.picker.Date.prototype.getDayInitial(a)},isEndOfWeek:function(b){b--;var a=b%7===0&&b!==0;return a?'</tr><tr role="row">':""},renderTodayBtn:function(a,b){Ext.DomHelper.generateMarkup(a.$comp.todayBtn.getRenderTree(),b)},renderMonthBtn:function(a,b){Ext.DomHelper.generateMarkup(a.$comp.monthBtn.getRenderTree(),b)},renderHourField:function(a,b){Ext.DomHelper.generateMarkup(a.$comp.hourField.getRenderTree(),b)},renderMinuteField:function(a,b){Ext.DomHelper.generateMarkup(a.$comp.minuteField.getRenderTree(),b)},renderSecondField:function(a,b){Ext.DomHelper.generateMarkup(a.$comp.secondField.getRenderTree(),b)}}],initHour:12,numDays:42,initComponent:function(){var a=this;a.selectedCls=a.baseCls+"-selected";a.disabledCellCls=a.baseCls+"-disabled";a.prevCls=a.baseCls+"-prevday";a.activeCls=a.baseCls+"-active";a.cellCls=a.baseCls+"-cell";a.nextCls=a.baseCls+"-prevday";a.todayCls=a.baseCls+"-today";if(!a.format){a.format=Ext.Date.defaultFormat}if(!a.dayNames){a.dayNames=Ext.Date.dayNames}a.dayNames=a.dayNames.slice(a.startDay).concat(a.dayNames.slice(0,a.startDay));a.callParent();a.value=a.value||new Date();a.initDisabledDays()},getRefOwner:function(){return this.pickerField||this.callParent()},getRefItems:function(){var b=[],d=this.monthBtn,c=this.todayBtn,f=this.hourField,e=this.minuteField,a=this.secondField;if(d){b.push(d)}if(c){b.push(c)}if(f){b.push(f)}if(e){b.push(e)}if(a){b.push(a)}return b},numberFieldDefaults:{allowBlank:false,allowDecimals:false,width:60,maxLength:2,autoStripChars:true,ariaRole:"presentation",enforceMaxLength:true},beforeRender:function(){var c=this,b=Ext.String.htmlEncode,d=new Array(c.numDays),a=Ext.Date.format(new Date(),c.format);if(c.padding&&!c.width){c.cacheWidth()}c.monthBtn=new Ext.button.Split({ownerCt:c,ownerLayout:c.getComponentLayout(),text:"",tooltip:c.monthYearText,tabIndex:-1,ariaRole:"presentation",listeners:{click:c.doShowMonthPicker,arrowclick:c.doShowMonthPicker,scope:c}});c.hourField=new Ext.form.field.Number(Ext.apply({ownerCt:c,ownerLayout:c.getComponentLayout(),maxValue:23,minValue:0},c.numberFieldDefaults));c.minuteField=new Ext.form.field.Number(Ext.apply({ownerCt:c,ownerLayout:c.getComponentLayout(),maxValue:59,minValue:0},c.numberFieldDefaults));c.secondField=new Ext.form.field.Number(Ext.apply({ownerCt:c,ownerLayout:c.getComponentLayout(),maxValue:59,minValue:0},c.numberFieldDefaults));if(c.showToday){c.todayBtn=new Ext.button.Button({ui:c.footerButtonUI,ownerCt:c,ownerLayout:c.getComponentLayout(),text:Ext.String.format(c.todayText,a),tooltip:Ext.String.format(c.todayTip,a),tooltipType:"title",tabIndex:-1,ariaRole:"presentation",handler:c.selectToday,scope:c})}c.callParent();Ext.applyIf(c,{renderData:{}});Ext.apply(c.renderData,{dayNames:c.dayNames,showToday:c.showToday,prevText:b(c.prevText),nextText:b(c.nextText),todayText:b(c.todayText),ariaMinText:b(c.ariaMinText),ariaMaxText:b(c.ariaMaxText),ariaDisabledDaysText:b(c.ariaDisabledDaysText),ariaDisabledDatesText:b(c.ariaDisabledDatesText),days:d});c.protoEl.unselectable()},cacheWidth:function(){var a=this,b=a.parseBox(a.padding),c=Ext.getBody().createChild({cls:a.baseCls+" "+a.borderBoxCls,style:"position:absolute;top:-1000px;left:-1000px;"});a.self.prototype.width=c.getWidth()+b.left+b.right;c.destroy()},onRender:function(b,a){var c=this,d="div."+c.baseCls+"-date";c.callParent(arguments);c.cells=c.eventEl.select("tbody td");c.textNodes=c.eventEl.query(d);c.eventEl.set({"aria-labelledby":c.monthBtn.id});c.mon(c.eventEl,{scope:c,mousewheel:c.handleMouseWheel,click:{fn:c.handleDateClick,delegate:d}})},initEvents:function(){var a=this;a.callParent();if(a.pickerField){a.el.on("mousedown",a.onMouseDown,a)}a.monthBtn.el.on("mousedown",a.onMouseDown,a);a.prevRepeater=new Ext.util.ClickRepeater(a.prevEl,{handler:a.showPrevMonth,scope:a,mousedownStopEvent:true});a.nextRepeater=new Ext.util.ClickRepeater(a.nextEl,{handler:a.showNextMonth,scope:a,mousedownStopEvent:true});a.keyNav=new Ext.util.KeyNav(a.eventEl,Ext.apply({scope:a,left:function(b){if(b.ctrlKey){this.showPrevMonth()}else{this.update(Ext.Date.add(this.activeDate,Ext.Date.DAY,-1))}b.preventDefault()},right:function(b){if(b.ctrlKey){this.showNextMonth()}else{this.update(Ext.Date.add(this.activeDate,Ext.Date.DAY,1))}b.preventDefault()},up:function(b){if(b.ctrlKey){this.showNextYear()}else{this.update(Ext.Date.add(this.activeDate,Ext.Date.DAY,-7))}b.preventDefault()},down:function(b){if(b.ctrlKey){this.showPrevYear()}else{this.update(Ext.Date.add(this.activeDate,Ext.Date.DAY,7))}b.preventDefault()},pageUp:function(b){if(b.ctrlKey){this.showPrevYear()}else{this.showPrevMonth()}b.preventDefault()},pageDown:function(b){if(b.ctrlKey){this.showNextYear()}else{this.showNextMonth()}b.preventDefault()},home:function(b){this.update(Ext.Date.getFirstDateOfMonth(this.activeDate));b.preventDefault()},end:function(b){this.update(Ext.Date.getLastDateOfMonth(this.activeDate));b.preventDefault()},tab:function(b){this.handleTabKey(b);return true},enter:function(b){this.handleDateClick(b,this.activeCell.firstChild)},space:function(f){var c=this,h=c.pickerField,b,d,g;c.setValue(new Date(c.activeCell.firstChild.dateValue));if(h){b=c.startValue;d=c.value;g=h.getValue();if(g&&b&&g.getTime()===d.getTime()){h.setValue(b)}else{h.setValue(d)}}f.preventDefault()}},a.keyNavConfig));if(a.disabled){a.syncDisabled(true,true)}a.update(a.value)},onMouseDown:function(b){var a=Ext.Component.fromElement(b.target);if(a.isFormField){return}},handleTabKey:function(f){var d=this,b=d.getSelectedDate(d.activeDate),c=d.handler,a;if(!d.disabled&&b.dateValue&&!Ext.fly(b.parentNode).hasCls(d.disabledCellCls)){a=b.dateValue;d.setValue(new Date(a.getFullYear(),a.getMonth()+1,a.getData(),d.hourField.getValue(),d.minuteField.getValue(),d.secondField.getValue()));d.fireEvent("select",d,d.value);if(c){Ext.callback(c,d.scope,[d,d.value],null,d,d)}d.onSelect()}else{d.fireEventArgs("tabout",[d])}},getSelectedDate:function(a){var d=this,h=Ext.Date.clearTime(a,true).getTime(),i=d.cells,j=d.selectedCls,f=i.elements,e=f.length,g,b;i.removeCls(j);for(b=0;b<e;b++){g=f[b].firstChild;if(g.dateValue===h){return g}}return null},initDisabledDays:function(){var g=this,b=g.disabledDates,f="(?:",a,h,c,e;if(!g.disabledDatesRE&&b){a=b.length-1;c=b.length;for(h=0;h<c;h++){e=b[h];f+=Ext.isDate(e)?"^"+Ext.String.escapeRegex(Ext.Date.dateFormat(e,g.format))+"$":e;if(h!==a){f+="|"}}g.disabledDatesRE=new RegExp(f+")")}},setDisabledDates:function(a){var b=this;if(Ext.isArray(a)){b.disabledDates=a;b.disabledDatesRE=null}else{b.disabledDatesRE=a}b.initDisabledDays();b.update(b.value,true);return b},setDisabledDays:function(a){this.disabledDays=a;return this.update(this.value,true)},setMinDate:function(a){this.minDate=a;return this.update(this.value,true)},setMaxDate:function(a){this.maxDate=a;return this.update(this.value,true)},setValue:function(a){this.value=a||new Date();return this.update(this.value)},getValue:function(){return this.value},getDayInitial:function(a){return a.substr(a.length-1)},onEnable:function(){var a=this;a.callParent();a.syncDisabled(false,true);a.update(a.activeDate)},onShow:function(){var a=this;a.callParent();a.syncDisabled(false);if(a.pickerField){a.startValue=a.pickerField.getValue()}},onHide:function(){this.callParent();this.syncDisabled(true)},onDisable:function(){this.callParent();this.syncDisabled(true,true)},getActive:function(){return this.activeDate||this.value},runAnimation:function(c){var b=this.monthPicker,a={duration:200,callback:function(){b.setVisible(!c)}};if(c){b.el.slideOut("t",a)}else{b.el.slideIn("t",a)}},hideMonthPicker:function(a){var c=this,b=c.monthPicker;if(b&&b.isVisible()){if(c.shouldAnimate(a)){c.runAnimation(true)}else{b.hide()}}return c},doShowMonthPicker:function(){this.showMonthPicker()},doHideMonthPicker:function(){this.hideMonthPicker()},showMonthPicker:function(a){var d=this,c=d.el,b;if(d.rendered&&!d.disabled){b=d.createMonthPicker();if(!b.isVisible()){b.setValue(d.getActive());b.setSize(c.getSize());b.floatParent=null;b.setPosition(-c.getBorderWidth("l"),-c.getBorderWidth("t"));if(d.shouldAnimate(a)){d.runAnimation(false)}else{b.show()}}}return d},shouldAnimate:function(a){return Ext.isDefined(a)?a:!this.disableAnim},createMonthPicker:function(){var b=this,a=b.monthPicker;if(!a){b.monthPicker=a=new Ext.picker.Month({renderTo:b.el,ownerCmp:b,floating:true,padding:b.padding,shadow:false,small:b.showToday===false,footerButtonUI:b.footerButtonUI,listeners:{scope:b,cancelclick:b.onCancelClick,okclick:b.onOkClick,yeardblclick:b.onOkClick,monthdblclick:b.onOkClick}});if(!b.disableAnim){a.el.setStyle("display","none")}a.hide();b.on("beforehide",b.doHideMonthPicker,b)}return a},onOkClick:function(b,e){var d=this,f=e[0],c=e[1],a=new Date(c,f,d.getActive().getDate());if(a.getMonth()!==f){a=Ext.Date.getLastDateOfMonth(new Date(c,f,1))}d.setValue(a);d.hideMonthPicker()},onCancelClick:function(){this.selectedUpdate(this.activeDate);this.hideMonthPicker()},showPrevMonth:function(a){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.MONTH,-1))},showNextMonth:function(a){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.MONTH,1))},showPrevYear:function(){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.YEAR,-1))},showNextYear:function(){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.YEAR,1))},handleMouseWheel:function(a){var b;a.stopEvent();if(!this.disabled){b=a.getWheelDelta();if(b>0){this.showPrevMonth()}else{if(b<0){this.showNextMonth()}}}},handleDateClick:function(f,b){var d=this,c=d.handler,a;f.stopEvent();if(!d.disabled&&b.dateValue&&!Ext.fly(b.parentNode).hasCls(d.disabledCellCls)){a=new Date(b.dateValue);d.setValue(new Date(a.getFullYear(),a.getMonth(),a.getDate(),d.hourField.getValue(),d.minuteField.getValue(),d.secondField.getValue()));d.fireEvent("select",d,d.value);if(c){Ext.callback(c,d.scope,[d,d.value],null,d,d)}d.onSelect()}},onSelect:function(){if(this.hideOnSelect){this.hide()}},selectToday:function(){var c=this,a=c.todayBtn,b=c.handler;if(a&&!a.disabled){c.setValue(new Date());c.fireEvent("select",c,c.value);if(b){Ext.callback(b,c.scope,[c,c.value],null,c,c)}c.onSelect()}return c},selectedUpdate:function(e){var g=this,f=Ext.Date.clearTime(e,true).getTime(),d=g.cells,b=g.selectedCls,i,h=d.getCount(),a;g.eventEl.dom.setAttribute("aria-busy","true");a=g.activeCell;if(a){Ext.fly(a).removeCls(b);a.setAttribute("aria-selected",false)}for(i=0;i<h;i++){a=d.item(i);if(g.textNodes[i].dateValue===f){g.activeCell=a.dom;g.eventEl.dom.setAttribute("aria-activedescendant",a.dom.id);a.dom.setAttribute("aria-selected",true);a.addCls(b);g.fireEvent("highlightitem",g,a);break}}g.eventEl.dom.removeAttribute("aria-busy")},fullUpdate:function(y){var C=this,d=C.cells.elements,c=C.textNodes,E=C.disabledCellCls,l=Ext.Date,u=0,B=0,j=+l.clearTime(y,true),x=+l.clearTime(new Date()),s=C.minDate?l.clearTime(C.minDate,true):Number.NEGATIVE_INFINITY,t=C.maxDate?l.clearTime(C.maxDate,true):Number.POSITIVE_INFINITY,A=C.disabledDatesRE,r=C.disabledDatesText,F=C.disabledDays?C.disabledDays.join(""):false,z=C.disabledDaysText,v=C.format,h=l.getDaysInMonth(y),o=l.getFirstDateOfMonth(y),e=o.getDay()-C.startDay,w=l.add(y,l.MONTH,-1),n=C.ariaTitleDateFormat,g,p,a,D,k,m,b,f,q;C.hourField.setValue(y.getHours());C.minuteField.setValue(y.getMinutes());C.secondField.setValue(y.getSeconds());if(e<0){e+=7}h+=e;g=l.getDaysInMonth(w)-e;p=new Date(w.getFullYear(),w.getMonth(),g,C.initHour);if(C.showToday){D=l.clearTime(new Date());a=(D<s||D>t||(A&&v&&A.test(l.dateFormat(D,v)))||(F&&F.indexOf(D.getDay())!==-1));C.todayDisabled=a;if(!C.disabled){C.todayBtn.setDisabled(a)}}k=function(H,G){var i=d[H],I=[];if(!i.hasAttribute("id")){i.setAttribute("id",C.id+"-cell-"+H)}q=+l.clearTime(p,true);i.firstChild.dateValue=q;i.setAttribute("aria-label",l.format(p,n));i.removeAttribute("aria-describedby");i.removeAttribute("data-qtip");if(q===x){G+=" "+C.todayCls;I.push(C.id+"-todayText")}if(q===j){C.activeCell=i;C.eventEl.dom.setAttribute("aria-activedescendant",i.id);i.setAttribute("aria-selected",true);G+=" "+C.selectedCls;C.fireEvent("highlightitem",C,i)}else{i.setAttribute("aria-selected",false)}if(q<s){G+=" "+E;I.push(C.id+"-ariaMinText");i.setAttribute("data-qtip",C.minText)}else{if(q>t){G+=" "+E;I.push(C.id+"-ariaMaxText");i.setAttribute("data-qtip",C.maxText)}else{if(F&&F.indexOf(p.getDay())!==-1){i.setAttribute("data-qtip",z);I.push(C.id+"-ariaDisabledDaysText");G+=" "+E}else{if(A&&v){f=l.dateFormat(p,v);if(A.test(f)){i.setAttribute("data-qtip",r.replace("%0",f));I.push(C.id+"-ariaDisabledDatesText");G+=" "+E}}}}}if(I.length){i.setAttribute("aria-describedby",I.join(" "))}i.className=G+" "+C.cellCls};C.eventEl.dom.setAttribute("aria-busy","true");for(;u<C.numDays;++u){if(u<e){m=(++g);b=C.prevCls}else{if(u>=h){m=(++B);b=C.nextCls}else{m=u-e+1;b=C.activeCls}}c[u].innerHTML=m;p.setDate(p.getDate()+1);k(u,b)}C.eventEl.dom.removeAttribute("aria-busy");C.monthBtn.setText(Ext.Date.format(y,C.monthYearFormat))},update:function(a,d){var b=this,c=b.activeDate;if(b.rendered){b.activeDate=a;if(!d&&c&&b.el&&c.getMonth()===a.getMonth()&&c.getFullYear()===a.getFullYear()){b.selectedUpdate(a,c)}else{b.fullUpdate(a,c)}}return b},privates:{finishRenderChildren:function(){var a=this;a.callParent();a.monthBtn.finishRender();a.hourField.finishRender();a.minuteField.finishRender();a.secondField.finishRender();if(a.showToday){a.todayBtn.finishRender()}},getFocusEl:function(){return this.eventEl},syncDisabled:function(c,b){var e=this,a=e.keyNav,d=e.todayBtn;if(a){a.setDisabled(c);e.prevRepeater.setDisabled(c);e.nextRepeater.setDisabled(c)}if(b&&d){d.setDisabled(e.todayDisabled||c)}}}});Ext.define("wys.form.field.date.DateTimePicker",{extend:"Ext.form.field.Picker",alias:"widget.datetimefield",requires:["wys.form.field.date.DateTime"],format:"Y-m-d H:i:s",ariaFormat:"Y-m-d H:i:s",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j",disabledDaysText:"禁用",ariaDisabledDaysText:"This day of week is disabled",disabledDatesText:"禁用",ariaDisabledDatesText:"日期不能被选择",minText:"该输入项的日期必须在 {0} 之后",ariaMinText:"该输入项的日期必须在 {0} 之后",maxText:"该输入项的日期必须在 {0} 之前",ariaMaxText:"该输入项的日期必须在 {0} 之前",invalidText:"{0} 是无效的日期 - 必须符合格式： {1}",formatText:"预期的日期格式为 {0}.",triggerCls:Ext.baseCSSPrefix+"form-date-trigger",showToday:true,editable:false,useStrict:undefined,initTime:"12",initTimeFormat:"H",matchFieldWidth:false,startDay:0,valuePublishEvent:["select","blur"],componentCls:Ext.baseCSSPrefix+"form-field-date",ariaRole:"combobox",rawDate:null,rawDateText:"",initComponent:function(){var d=this,b=Ext.isString,c,a;c=d.minValue;a=d.maxValue;if(b(c)){d.minValue=d.parseDate(c)}if(b(a)){d.maxValue=d.parseDate(a)}d.disabledDatesRE=null;d.initDisabledDays();d.callParent()},getSubTplData:function(b){var c=this,d,a;d=c.callParent([b]);if(!c.ariaStaticRoles[c.ariaRole]){a=d.ariaElAttributes;if(a){a["aria-owns"]=c.id+"-inputEl "+c.id+"-picker-eventEl";a["aria-autocomplete"]="none"}}return d},initValue:function(){var a=this,b=a.value;if(Ext.isString(b)){a.value=a.rawToValue(b);a.rawDate=a.value;a.rawDateText=a.parseDate(a.value)}else{a.value=b||null;a.rawDate=a.value;a.rawDateText=a.value?a.parseDate(a.value):""}a.callParent()},initDisabledDays:function(){if(this.disabledDates){var b=this.disabledDates,a=b.length-1,f="(?:",g,e=b.length,c;for(g=0;g<e;g++){c=b[g];f+=Ext.isDate(c)?"^"+Ext.String.escapeRegex(c.dateFormat(this.format))+"$":c;if(g!==a){f+="|"}}this.disabledDatesRE=new RegExp(f+")")}},setDisabledDates:function(c){var b=this,a=b.picker;b.disabledDates=c;b.initDisabledDays();if(a){a.setDisabledDates(b.disabledDatesRE)}},setDisabledDays:function(b){var a=this.picker;this.disabledDays=b;if(a){a.setDisabledDays(b)}},setMinValue:function(d){var b=this,a=b.picker,c=(Ext.isString(d)?b.parseDate(d):d);b.minValue=c;if(a){a.minText=Ext.String.format(b.minText,b.formatDate(b.minValue));a.setMinDate(c)}},setMaxValue:function(c){var b=this,a=b.picker,d=(Ext.isString(c)?b.parseDate(c):c);b.maxValue=d;if(a){a.maxText=Ext.String.format(b.maxText,b.formatDate(b.maxValue));a.setMaxDate(d)}},getErrors:function(p){p=arguments.length>0?p:this.formatDate(this.processRawValue(this.getRawValue()));var h=this,o=Ext.String.format,j=Ext.Date.clearTime,n=h.callParent([p]),m=h.disabledDays,d=h.disabledDatesRE,l=h.minValue,g=h.maxValue,f=m?m.length:0,e=0,a,b,k,c;if(p===null||p.length<1){return n}a=p;p=h.parseDate(p);if(!p){n.push(o(h.invalidText,a,Ext.Date.unescapeFormat(h.format)));return n}c=p.getTime();if(l&&c<j(l).getTime()){n.push(o(h.minText,h.formatDate(l)))}if(g&&c>j(g).getTime()){n.push(o(h.maxText,h.formatDate(g)))}if(m){k=p.getDay();for(;e<f;e++){if(k===m[e]){n.push(h.disabledDaysText);break}}}b=h.formatDate(p);if(d&&d.test(b)){n.push(o(h.disabledDatesText,b))}return n},rawToValue:function(b){var a=this;if(b===a.rawDateText){return a.rawDate}return a.parseDate(b)||b||null},valueToRaw:function(a){return this.formatDate(this.parseDate(a))},setValue:function(a){var b=this;b.lastValue=b.rawDateText;b.lastDate=b.rawDate;if(Ext.isDate(a)){b.rawDate=a;b.rawDateText=b.formatDate(a)}else{b.rawDate=b.rawToValue(a);b.rawDateText=b.formatDate(a);if(b.rawDate===a){b.rawDate=null;b.rawDateText=""}}b.callParent(arguments)},checkChange:function(){var d=this,c,a,b;if(!d.suspendCheckChange){c=d.getRawValue();a=d.lastValue;b=d.lastDate;if(!d.destroyed&&d.didValueChange(c,a)){d.rawDate=d.rawToValue(c);d.rawDateText=d.formatDate(c);d.lastValue=c;d.lastDate=d.rawDate;d.fireEvent("change",d,d.getValue(),b);d.onChange(c,a)}}},safeParse:function(f,g){var e=this,c=Ext.Date,a=null,b=e.useStrict,d;if(c.formatContainsHourInfo(g)){a=c.parse(f,g,b)}else{d=c.parse(f+" "+e.initTime,g+" "+e.initTimeFormat,b);if(d){a=c.clearTime(d)}}return a},getSubmitValue:function(){var b=this.submitFormat||this.format,a=this.rawDate;return a?Ext.Date.format(a,b):""},getValue:function(){return this.rawDate||null},setRawValue:function(b){var a=this;a.callParent([b]);a.rawDate=Ext.isDate(b)?b:a.rawToValue(b);a.rawDateText=this.formatDate(b)},parseDate:function(e){if(!e||Ext.isDate(e)){return e}var d=this,g=d.safeParse(e,d.format),b=d.altFormats,f=d.altFormatsArray,c=0,a;if(!g&&b){f=f||b.split("|");a=f.length;for(;c<a&&!g;++c){g=d.safeParse(e,f[c])}}return g},formatDate:function(a,b){return Ext.isDate(a)?Ext.Date.dateFormat(a,b||this.format):a},createPicker:function(){var a=this,b=Ext.String.format;return new wys.form.field.date.DateTime({id:a.id+"-picker",pickerField:a,floating:true,preventRefocus:true,hidden:true,minDate:a.minValue,maxDate:a.maxValue,disabledDatesRE:a.disabledDatesRE,disabledDatesText:a.disabledDatesText,ariaDisabledDatesText:a.ariaDisabledDatesText,disabledDays:a.disabledDays,disabledDaysText:a.disabledDaysText,ariaDisabledDaysText:a.ariaDisabledDaysText,format:a.format,showToday:a.showToday,startDay:a.startDay,minText:b(a.minText,a.formatDate(a.minValue)),ariaMinText:b(a.ariaMinText,a.formatDate(a.minValue,a.ariaFormat)),maxText:b(a.maxText,a.formatDate(a.maxValue)),ariaMaxText:b(a.ariaMaxText,a.formatDate(a.maxValue,a.ariaFormat)),listeners:{scope:a,select:a.onSelect,tabout:a.onTabOut},keyNavConfig:{esc:function(){a.inputEl.focus();a.collapse()}}})},onSelect:function(a,c){var b=this;b.setValue(c);b.rawDate=c;b.fireEvent("select",b,c);b.onTabOut(a)},onTabOut:function(a){this.inputEl.focus();this.collapse()},onExpand:function(){var a=this.rawDate;this.picker.setValue(Ext.isDate(a)?a:new Date())},onBlur:function(c){var b=this,a=b.rawToValue(b.getRawValue());if(a===""||Ext.isDate(a)){b.setValue(a)}b.callParent([c])}});Ext.define("wys.grid.column.AreaColumn",{extend:"Ext.grid.column.Column",requires:["wys.form.field.CityPicker"],alias:"widget.areacolumn",constructor:function(){this.scope=this;this.callParent(arguments)},initComponent:function(){var a=this;a.callParent(arguments)},defaultRenderer:function(c){var b=this;var a="";Ext.create("wys.form.field.CityPicker",{valueField:"city",displayField:"cityText"}).getViewModel().getData().pickerCities.getData().each(function(d,h){var f=d.data;if(f.province.toString()===c||f.city.toString()===c){a=f.cityText;return true}});return a},updater:function(a,b){Ext.fly(a).down(this.getView().innerSelector,true).innerHTML=Ext.grid.column.Number.prototype.defaultRenderer.call(this,b)}});Ext.define("wys.grid.column.Command",{extend:"Ext.grid.column.Column",alias:"widget.command",commandWidth:18,dataIndex:"",menuDisabled:true,sortable:false,hideable:false,isColumn:true,isCommandColumn:true,adjustmentWidth:4,constructor:function(a){var b=this;b.callParent(arguments);b.commands=b.commands||[];if(b.autoWidth){b.width=b.minWidth=b.commandWidth*b.commands.length+b.adjustmentWidth;b.fixed=true}b.renderer=Ext.Function.bind(b.renderer,b)},initRenderData:function(){var b=this;b.gridRef=b.up("tablepanel");b.gridRef.addCls("x-grid-group-imagecommand");var a=b.getGroupingFeature(b.gridRef);if(b.groupCommands&&a){b.gridRef.view.on("groupclick",b.onGroupClick,b);b.gridRef.view.on("containerclick",b.onClick,b);if(Ext.isString(a.groupHeaderTpl)){a.groupHeaderTpl='<div class="group-row-imagecommand-cell">'+a.groupHeaderTpl+"</div>"+this.groupCommandTemplate}else{if(a.groupHeaderTpl&&a.groupHeaderTpl.html){a.groupHeaderTpl.html='<div class="group-row-imagecommand-cell">'+a.groupHeaderTpl.html+"</div>"+this.groupCommandTemplate}}a.commandColumn=b;a.setupRowData=Ext.Function.createSequence(a.setupRowData,this.getGroupData,this)}return b.callParent(arguments)},afterHide:function(){this.callParent(arguments);Ext.select(".x-grid-cell-"+this.id).addCls("x-hide-command")},afterShow:function(){this.callParent(arguments);Ext.select(".x-grid-cell-"+this.id).removeCls("x-hide-command")},getGroupData:function(g,j,l){var h=[],f,c,d,k=this.groupCommands;if(!l.isFirstRow){return}for(f=0;f<k.length;f++){c=k[f];if(c.iconCls&&c.iconCls.charAt(0)==="#"){c.iconCls=X.net.RM.getIcon(c.iconCls.substring(1))}}var e=g.get(this.getGroupingFeature(this.gridRef).refreshData.groupField),b=e?this.gridRef.store.getGroups().get(e).items:null;if(this.prepareGroupCommands){k=Ext.net.clone(this.groupCommands);this.prepareGroupCommands(this.gridRef,k,e,b)}for(f=0;f<k.length;f++){c=k[f];c.tooltip=c.tooltip||{};if(c.iconCls&&c.iconCls.charAt(0)==="#"){c.iconCls=X.net.RM.getIcon(c.iconCls.substring(1))}d={command:c.command,cls:c.cls,iconCls:c.iconCls,hidden:c.hidden,disabled:c.disabled,text:c.text,style:c.style,qtext:c.tooltip.text,qtitle:c.tooltip.title,hideMode:c.hideMode,rightAlign:c.rightAlign||false};if(this.prepareGroupCommand){this.prepareGroupCommand(this.gridRef,d,e,b)}if(d.iconCls&&d.iconCls.charAt(0)==="#"){d.iconCls=X.net.RM.getIcon(d.iconCls.substring(1))}if(d.disabled){d.cls=(d.cls||"")+" x-imagecommand-disabled"}if(d.hidden){var a=d.hideMode||"display";d.hideCls="x-hidden-"+a}if(d.rightAlign){d.align="right-group-imagecommand"}else{d.align=""}h.push(d)}l.metaGroupCache.commands=h},getGroupingFeature:function(a){return a.groupingFeature},processEvent:function(g,b,a,d,f,h){if((g==="click")&&h.getTarget(".row-imagecommand",3)){this.onClick(b,h,d,f);if(this.stopSelection!==false){var i=this.gridRef.getSelectionModel(),c=i.locked;i.locked=true;Ext.defer(function(){i.locked=c},1)}}return this.callParent(arguments)},onGroupClick:function(b,d,h,g){var c=g.getTarget(".group-row-imagecommand"),f;if(c){var a=this.gridRef.store.groupField;f=Ext.fly(c).getAttribute("cmd");if(Ext.isEmpty(f,false)||Ext.fly(c).hasCls("x-imagecommand-disabled")){return}this.fireEvent("groupcommand",this,f,this.gridRef.store.getGroups().get(h))}return !c},onClick:function(j,h,f,i){var j=this.gridRef.getView(),b,g,c,k=h.getTarget(".row-imagecommand");if(k){b=Ext.fly(k).getAttribute("cmd");if(Ext.isEmpty(b,false)||Ext.fly(k).hasCls("x-imagecommand-disabled")){return}var l=h.getTarget(".x-grid-row");if(l===false){return}if(this!==this.gridRef.headerCt.getHeaderAtIndex(i)){return}c=Ext.fly(k).getAttribute("recordId");if(c&&this.gridRef.store.getAt){g=this.gridRef.store.getByInternalId(c)}else{g=this.gridRef.store.getAt?this.gridRef.store.getAt(f):j.getRecord(j.getNode(f))}this.fireEvent("command",this,b,g,f,i)}k=h.getTarget(".group-row-imagecommand");if(k){var a=this.gridRef.store.groupField,d=Ext.fly(k).getAttribute("data-groupname");b=Ext.fly(k).getAttribute("cmd");if(Ext.isEmpty(b,false)||Ext.fly(k).hasCls("x-imagecommand-disabled")){return}this.fireEvent("groupcommand",this,b,this.gridRef.store.getGroups().get(d))}},renderer:function(l,n,h,o,c,m){var e;n.tdCls=n.tdCls||"";n.style="margin-left:2px;";n.tdCls+=" row-imagecommand-cell";if(n){n.tdCls=n.tdCls||"";n.tdCls+=" row-imagecommand-cell"}else{e=view.getNode(h);if(e){e=Ext.fly(e).down("td[data-columnid="+this.id+"]");if(e){e.addCls("row-imagecommand-cell")}}}if(this.isHidden()){if(n){n.tdCls+=" x-hide-command"}else{if(e){e.addCls("x-hide-command")}}}if(this.commands){var k=this,j=[],g,d,f,b=this.commands;for(g=0;g<b.length;g++){d=b[g];if(d.iconCls&&d.iconCls.charAt(0)==="#"){d.iconCls=X.net.RM.getIcon(d.iconCls.substring(1))}}if(this.prepareCommands){b=Ext.net.clone(this.commands);this.prepareCommands(this.gridRef,b,h,o)}for(g=0;g<b.length;g++){d=b[g];d.tooltip=d.tooltip||{};if(d.iconCls&&d.iconCls.charAt(0)==="#"){d.iconCls=X.net.RM.getIcon(d.iconCls.substring(1))}f={command:d.command,recordId:h.internalId,cls:d.cls,iconCls:d.iconCls,hidden:d.hidden,disabled:d.disabled,text:d.text,style:d.style,qtext:d.tooltip.text||d.text,qtitle:d.tooltip.title,qclass:d.tooltip.cls,qwidth:d.tooltip.width,qheight:d.tooltip.height,hideMode:d.hideMode,renderer:d.renderer};if(typeof d.renderer==="function"){d.renderer(f,h)}if(this.prepareCommand){this.prepareCommand(this.gridRef,f,h,o)}if(f.iconCls&&f.iconCls.charAt(0)==="#"){f.iconCls=X.net.RM.getIcon(f.iconCls.substring(1))}if(f.disabled){f.cls=(f.cls||"")+" x-imagecommand-disabled"}if(f.hidden){var a=f.hideMode||"display";f.hideCls="x-hidden-"+a}if(Ext.isIE6&&Ext.isEmpty(d.text,false)){f.noTextCls="no-row-imagecommand-text"}j.push(f)}return this.getRowTemplate().apply({commands:j})}return""},commandTemplate:'<div class="row-imagecommands"><tpl for="commands"><div recordId="{recordId}" cmd="{command}" class="row-imagecommand {cls} {noTextCls} {iconCls} {hideCls}" style="{style}" data-qtip="{qtext}" data-qtitle="{qtitle}" data-qclass="{qclass}" data-qwidth="{qwidth}" data-qheight="{qheight}"><tpl if="text"><span data-qtip="{qtext}" data-qtitle="{qtitle}" data-qclass="{qclass}" data-qwidth="{qwidth}" data-qheight="{qheight}">{text}</span></tpl></div></tpl></div>',groupCommandTemplate:'<tpl for="commands"><div cmd="{command}" class="group-row-imagecommand {cls} {iconCls} {hideCls} {align}" style="{style}" data-qtip="{qtext}" data-qtitle="{qtitle}"><tpl if="text"><span data-qtip="{qtext}" data-qtitle="{qtitle}" class="{cls}">{text}</span></tpl></div></tpl>',getRowTemplate:function(){if(Ext.isEmpty(this.rowTemplate)){this.rowTemplate=new Ext.XTemplate(this.commandTemplate)}return this.rowTemplate}});Ext.define("wys.plugs.ComboTree",{extend:"Ext.form.field.Picker",xtype:"comboTree",uses:["Ext.tree.Panel"],rootVisible:false,triggerCls:Ext.baseCSSPrefix+"form-arrow-trigger",config:{store:null,displayField:null,columns:null,selectOnTab:true,maxPickerHeight:600,minPickerHeight:300,autoScroll:true},editable:false,initComponent:function(){var a=this;a.callParent(arguments);a.mon(a.store,{scope:a,load:a.onLoad,update:a.onUpdate})},createPicker:function(){var c=this,b=new Ext.tree.Panel({shrinkWrapDock:2,store:c.store,rootVisible:false,floating:true,displayField:c.displayField,columns:c.columns,minHeight:c.minPickerHeight,autoWidth:true,minWidth:400,border:true,maxHeight:c.maxPickerHeight,manageHeight:false,autoScroll:c.autoScroll,shadow:false,listeners:{scope:c,itemclick:c.onItemClick},viewConfig:{listeners:{scope:c,render:c.onViewRender}}}),a=b.getView();if(Ext.isIE9&&Ext.isStrict){a.on({scope:c,highlightitem:c.repaintPickerView,unhighlightitem:c.repaintPickerView,afteritemexpand:c.repaintPickerView,afteritemcollapse:c.repaintPickerView})}return b},onViewRender:function(a){a.getEl().on("keypress",this.onPickerKeypress,this)},repaintPickerView:function(){var a=this.picker.getView().getEl().dom.style;a.display=a.display},onItemClick:function(b,a,c,f,d){this.selectItem(a)},onPickerKeypress:function(c,b){var a=c.getKey();if(a===c.ENTER||(a===c.TAB&&this.selectOnTab)){this.selectItem(this.picker.getSelectionModel().getSelection()[0])}},selectItem:function(a){var b=this;b.setValue(a.getId());b.fireEvent("select",b,a);b.collapse()},onExpand:function(){var d=this,b=d.picker,a=b.store,e=d.value,c;if(e){c=a.getNodeById(e)}if(!c){c=a.getRoot()}b.selectPath(c.getPath())},setValue:function(c){var b=this,a;b.value=c;if(b.store.loading){return b}a=c?b.store.getNodeById(c):b.store.getRoot();if(c===undefined){a=b.store.getRoot();try{b.value=a.getId()}catch(d){}}else{a=b.store.getNodeById(c)}b.setRawValue(a?a.get(b.displayField):"");return b},getSubmitValue:function(){return this.value},getValue:function(){return this.value},onLoad:function(){var a=this.value;if(a){this.setValue(a)}},onUpdate:function(a,e,b,c){var d=this.displayField;if(b==="edit"&&c&&Ext.Array.contains(c,d)&&this.value===e.getId()){this.setRawValue(e.get(d))}}});Ext.define("wys.plugs.ConvertTableToExt",{extend:"Ext.grid.Panel",constructor:function(q,f){f=Ext.apply({},f);q=this.table=Ext.get(q);var j=f.fields||[],c=f.columns||[],k=[],m=[],e=q.query("thead th"),h=0,l=e.length,g=q.dom,b,p,n,d,o,a;for(;h<l;++h){d=e[h];o=d.innerHTML;a="tcol-"+h;k.push(Ext.applyIf(j[h]||{},{name:a,mapping:"td:nth("+(h+1)+")/@innerHTML"}));m.push(Ext.applyIf(c[h]||{},{text:o,dataIndex:a,width:d.offsetWidth,tooltip:d.title,sortable:true}))}if(f.width){b=f.width}else{b=q.getWidth()+1}if(f.height){p=f.height}Ext.applyIf(f,{store:{data:g,fields:k,proxy:{type:"memory",reader:{record:"tbody tr",type:"xml"}}},columns:m,width:b,height:p});this.callParent([f]);if(f.remove!==false){g.parentNode.removeChild(g)}},onDestroy:function(){this.callParent();this.table.remove();delete this.table}});Ext.define("wys.plugs.Frame",{extend:"Ext.Component",alias:"widget.iframe",loadMask:constants.system_msg.dataLoad,src:"about:blank",renderTpl:['<iframe src="{src}" id="{id}-iframeEl" data-ref="iframeEl" name="{frameName}" width="100%" height="100%" frameborder="0"></iframe>'],childEls:["iframeEl"],initComponent:function(){this.callParent();this.frameName=this.frameName||this.id+"-frame"},initEvents:function(){var a=this;a.callParent();a.iframeEl.on("load",a.onLoad,a)},initRenderData:function(){return Ext.apply(this.callParent(),{src:this.src,frameName:this.frameName})},getBody:function(){var a=this.getDoc();return a.body||a.documentElement},getDoc:function(){try{return this.getWin().document}catch(a){return null}},getWin:function(){var b=this,a=b.frameName,c=Ext.isIE?b.iframeEl.dom.contentWindow:window.frames[a];return c},getFrame:function(){var a=this;return a.iframeEl.dom},beforeDestroy:function(){this.cleanupListeners(true);this.callParent()},cleanupListeners:function(c){var b,d;if(this.rendered){try{b=this.getDoc();if(b){Ext.get(b).un(this._docListeners);if(c){for(d in b){if(b.hasOwnProperty&&b.hasOwnProperty(d)){delete b[d]}}}}}catch(a){}}},onLoad:function(){var b=this,d=b.getDoc(),a=b.onRelayedEvent;if(d){try{Ext.get(d).on(b._docListeners={mousedown:a,mousemove:a,mouseup:a,click:a,dblclick:a,scope:b})}catch(c){}Ext.get(this.getWin()).on("beforeunload",b.cleanupListeners,b);this.el.unmask();this.fireEvent("load",this)}else{if(b.src){this.el.unmask();this.fireEvent("error",this)}}},onRelayedEvent:function(c){var b=this.iframeEl,d=b.getTrueXY(),e=c.getXY(),a=c.getTrueXY();c.xy=[d[0]+a[0],d[1]+a[1]];c.injectEvent(b);c.xy=e},load:function(d){var a=this,c=a.loadMask,b=a.getFrame();if(a.fireEvent("beforeload",a,d)!==false){if(c&&a.el){a.el.mask(c)}b.src=a.src=(d||a.src)}}});Ext.define("wys.plugs.MyDateField",{extend:"Ext.form.field.Display",alias:"widget.myDateField",editable:false,emptyText:"&nbsp;",fieldCls:"x-form-field-my",initComponent:function(){Ext.apply(this,{border:false,emptyText:"&nbsp;",listeners:{render:function(c,b){var a=c.getValue();c.emptyText="&nbsp;";if(Ext.isEmpty(a)===true){}else{c.setValue(Ext.util.Format.date(new Date(a),"Y-m-d H:i"))}},change:function(c,b){var a=c.getValue();c.emptyText="&nbsp;";if(Ext.isEmpty(a)===true){}else{c.setValue(Ext.util.Format.date(new Date(a),"Y-m-d H:i"))}}},inputWrapCls:"x-form-field-my"});this.callParent()}});Ext.define("wys.plugs.MyFormLayout",{extend:"Ext.form.Panel",xtype:"myFormLayout",singlton:true,requires:["Ext.container.Container"],baseColumn:"",baseColumnField:[],otherSplitName:"",otherContainerColumn:"",otherContainerColumnField:[],constructor:function(d,a,e,b,c){this.baseColumn=d;this.baseColumnField=a;this.otherSplitName=e;this.otherContainerColumn=b;this.otherContainerColumnField=c},buildBaseComponent:function(){var a={xtype:"container",anchor:"100%",layout:"hbox",items:[]}},buildOtherComponent:function(){}});Ext.define("wys.plugs.MyTextField",{extend:"Ext.form.field.Display",alias:"widget.myTextField",editable:false,fieldCls:"x-form-field-my",initComponent:function(){Ext.apply(this,{border:false,listeners:{render:function(c,b){var a=c.getValue();if(Ext.isEmpty(a)){c.setValue("    &nbsp;")}},change:function(c,b){var a=c.getValue();if(Ext.isEmpty(a)){c.setValue("&nbsp;&nbsp;")}}},inputWrapCls:"x-form-field-my"});this.callParent()}});Ext.define("wys.plugs.Notification",{extend:"Ext.window.Window",alias:"widget.notification",autoClose:true,autoHeight:true,plain:false,draggable:false,shadow:false,focus:Ext.emptyFn,manager:null,useXAxis:false,position:"br",spacing:6,paddingX:30,paddingY:10,slideInAnimation:"easeIn",slideBackAnimation:"bounceOut",slideInDuration:1500,slideBackDuration:1000,hideDuration:500,autoCloseDelay:7000,stickOnClick:true,stickWhileHover:true,isHiding:false,isFading:false,destroyAfterHide:false,closeOnMouseOut:false,xPos:0,yPos:0,statics:{defaultManager:{el:null}},initComponent:function(){var a=this;if(Ext.isDefined(a.corner)){a.position=a.corner}if(Ext.isDefined(a.slideDownAnimation)){a.slideBackAnimation=a.slideDownAnimation}if(Ext.isDefined(a.autoDestroyDelay)){a.autoCloseDelay=a.autoDestroyDelay}if(Ext.isDefined(a.autoHideDelay)){a.autoCloseDelay=a.autoHideDelay}if(Ext.isDefined(a.autoHide)){a.autoClose=a.autoHide}if(Ext.isDefined(a.slideInDelay)){a.slideInDuration=a.slideInDelay}if(Ext.isDefined(a.slideDownDelay)){a.slideBackDuration=a.slideDownDelay}if(Ext.isDefined(a.fadeDelay)){a.hideDuration=a.fadeDelay}a.position=a.position.replace(/c/,"");a.updateAlignment(a.position);a.setManager(a.manager);a.callParent(arguments)},onRender:function(){var a=this;a.callParent(arguments);a.el.hover(function(){a.mouseIsOver=true},function(){a.mouseIsOver=false;if(a.closeOnMouseOut){a.closeOnMouseOut=false;a.close()}},a)},updateAlignment:function(a){var b=this;switch(a){case"br":b.paddingFactorX=-1;b.paddingFactorY=-1;b.siblingAlignment="br-br";if(b.useXAxis){b.managerAlignment="bl-br"}else{b.managerAlignment="tr-br"}break;case"bl":b.paddingFactorX=1;b.paddingFactorY=-1;b.siblingAlignment="bl-bl";if(b.useXAxis){b.managerAlignment="br-bl"}else{b.managerAlignment="tl-bl"}break;case"tr":b.paddingFactorX=-1;b.paddingFactorY=1;b.siblingAlignment="tr-tr";if(b.useXAxis){b.managerAlignment="tl-tr"}else{b.managerAlignment="br-tr"}break;case"tl":b.paddingFactorX=1;b.paddingFactorY=1;b.siblingAlignment="tl-tl";if(b.useXAxis){b.managerAlignment="tr-tl"}else{b.managerAlignment="bl-tl"}break;case"b":b.paddingFactorX=0;b.paddingFactorY=-1;b.siblingAlignment="b-b";b.useXAxis=0;b.managerAlignment="t-b";break;case"t":b.paddingFactorX=0;b.paddingFactorY=1;b.siblingAlignment="t-t";b.useXAxis=0;b.managerAlignment="b-t";break;case"l":b.paddingFactorX=1;b.paddingFactorY=0;b.siblingAlignment="l-l";b.useXAxis=1;b.managerAlignment="r-l";break;case"r":b.paddingFactorX=-1;b.paddingFactorY=0;b.siblingAlignment="r-r";b.useXAxis=1;b.managerAlignment="l-r";break}},getXposAlignedToManager:function(){var a=this;var b=0;if(a.manager&&a.manager.el&&a.manager.el.dom){if(!a.useXAxis){return a.el.getLeft()}else{if(a.position=="br"||a.position=="tr"||a.position=="r"){b+=a.manager.el.getAnchorXY("r")[0];b-=(a.el.getWidth()+a.paddingX)}else{b+=a.manager.el.getAnchorXY("l")[0];b+=a.paddingX}}}return b},getYposAlignedToManager:function(){var b=this;var a=0;if(b.manager&&b.manager.el&&b.manager.el.dom){if(b.useXAxis){return b.el.getTop()}else{if(b.position=="br"||b.position=="bl"||b.position=="b"){a+=b.manager.el.getAnchorXY("b")[1];a-=(b.el.getHeight()+b.paddingY)}else{a+=b.manager.el.getAnchorXY("t")[1];a+=b.paddingY}}}return a},getXposAlignedToSibling:function(a){var b=this;if(b.useXAxis){if(b.position=="tl"||b.position=="bl"||b.position=="l"){return(a.xPos+a.el.getWidth()+a.spacing)}else{return(a.xPos-b.el.getWidth()-b.spacing)}}else{return b.el.getLeft()}},getYposAlignedToSibling:function(a){var b=this;if(b.useXAxis){return b.el.getTop()}else{if(b.position=="tr"||b.position=="tl"||b.position=="t"){return(a.yPos+a.el.getHeight()+a.spacing)}else{return(a.yPos-b.el.getHeight()-a.spacing)}}},getNotifications:function(b){var a=this;if(!a.manager.notifications[b]){a.manager.notifications[b]=[]}return a.manager.notifications[b]},setManager:function(a){var b=this;b.manager=a;if(typeof b.manager=="string"){b.manager=Ext.getCmp(b.manager)}if(!b.manager){b.manager=b.statics().defaultManager;if(!b.manager.el){b.manager.el=Ext.getBody()}}if(typeof b.manager.notifications=="undefined"){b.manager.notifications={}}},beforeShow:function(){var a=this;if(a.stickOnClick){if(a.body&&a.body.dom){Ext.fly(a.body.dom).on("click",function(){a.cancelAutoClose();a.addCls("notification-fixed")},a)}}if(a.autoClose){a.task=new Ext.util.DelayedTask(a.doAutoClose,a);a.task.delay(a.autoCloseDelay)}a.el.setX(-10000);a.el.setOpacity(1)},afterShow:function(){var b=this;b.callParent(arguments);var a=b.getNotifications(b.managerAlignment);if(a.length){b.el.alignTo(a[a.length-1].el,b.siblingAlignment,[0,0]);b.xPos=b.getXposAlignedToSibling(a[a.length-1]);b.yPos=b.getYposAlignedToSibling(a[a.length-1])}else{b.el.alignTo(b.manager.el,b.managerAlignment,[(b.paddingX*b.paddingFactorX),(b.paddingY*b.paddingFactorY)],false);b.xPos=b.getXposAlignedToManager();b.yPos=b.getYposAlignedToManager()}Ext.Array.include(a,b);b.el.animate({from:{x:b.el.getX(),y:b.el.getY()},to:{x:b.xPos,y:b.yPos,opacity:1},easing:b.slideInAnimation,duration:b.slideInDuration,dynamic:true})},slideBack:function(){var c=this;var b=c.getNotifications(c.managerAlignment);var a=Ext.Array.indexOf(b,c);if(!c.isHiding&&c.el&&c.manager&&c.manager.el&&c.manager.el.dom&&c.manager.el.isVisible()){if(a){c.xPos=c.getXposAlignedToSibling(b[a-1]);c.yPos=c.getYposAlignedToSibling(b[a-1])}else{c.xPos=c.getXposAlignedToManager();c.yPos=c.getYposAlignedToManager()}c.stopAnimation();c.el.animate({to:{x:c.xPos,y:c.yPos},easing:c.slideBackAnimation,duration:c.slideBackDuration,dynamic:true})}},cancelAutoClose:function(){var a=this;if(a.autoClose){a.task.cancel()}},doAutoClose:function(){var a=this;if(!(a.stickWhileHover&&a.mouseIsOver)){a.close()}else{a.closeOnMouseOut=true}},removeFromManager:function(){var c=this;if(c.manager){var b=c.getNotifications(c.managerAlignment);var a=Ext.Array.indexOf(b,c);if(a!=-1){Ext.Array.erase(b,a,1);for(;a<b.length;a++){b[a].slideBack()}}}},hide:function(){var a=this;if(a.isHiding){if(!a.isFading){a.callParent(arguments);a.isHiding=false}}else{a.isHiding=true;a.isFading=true;a.cancelAutoClose();if(a.el){a.el.fadeOut({opacity:0,easing:"easeIn",duration:a.hideDuration,remove:a.destroyAfterHide,listeners:{afteranimate:function(){a.isFading=false;a.removeCls("notification-fixed");a.removeFromManager();a.hide(a.animateTarget,a.doClose,a)}}})}}return a},destroy:function(){var a=this;if(!a.hidden){a.destroyAfterHide=true;a.hide(a.animateTarget,a.doClose,a)}else{a.callParent(arguments)}}});Ext.define("wys.plugs.RowEditing",{extend:"Ext.grid.plugin.Editing",alias:"plugin.rowEditing",requires:["Ext.grid.RowEditor"],lockableScope:"top",editStyle:"row",autoCancel:true,errorSummary:true,constructor:function(){var a=this;a.callParent(arguments);if(!a.clicksToMoveEditor){a.clicksToMoveEditor=a.clicksToEdit}a.autoCancel=!!a.autoCancel},init:function(a){this.callParent([a]);if(a.lockedGrid){a.lockedGrid.registerActionable(this);a.normalGrid.registerActionable(this)}else{a.registerActionable(this)}},destroy:function(){Ext.destroy(this.editor);this.callParent()},onBeforeReconfigure:function(){this.callParent(arguments);this.cancelEdit()},onReconfigure:function(d,b,c){var a=this.editor;this.callParent(arguments);if(c&&a&&a.rendered){a.needsSyncFieldWidths=true}},shouldStartEdit:function(a){return true},startEdit:function(a,e){var d=this,c=d.getEditor(),b;if(Ext.isEmpty(e)){e=d.grid.getTopLevelVisibleColumnManager().getHeaderAtIndex(0)}if(c.beforeEdit()!==false){b=d.getEditingContext(a,e);if(b&&d.beforeEdit(b)!==false&&d.fireEvent("beforeedit",d,b)!==false&&!b.cancel){d.context=b;if(d.lockingPartner){d.lockingPartner.cancelEdit()}c.startEdit(b.record,b.column,b);d.editing=true;return true}}return false},activateCell:function(a){if(!a.getCell().query('[tabIndex="-1"]').length){this.startEdit(a.record,a.column);return true}},onEnterKey:function(c){var a=this,b;if(!a.grid.ownerGrid.actionableMode&&a.editing){b=Ext.getCmp(c.getTarget().getAttribute("componentId"));if(!(b&&b.isPickerField&&b.isExpanded)){a.completeEdit()}}},cancelEdit:function(){var a=this;if(a.editing){a.getContextFieldValues();a.getEditor().cancelEdit();a.callParent(arguments);return}return true},completeEdit:function(){var b=this,a=b.context;if(b.editing&&b.validateEdit(a)){b.editing=false;b.fireEvent("edit",b,a)}},validateEdit:function(){this.getContextFieldValues();return this.callParent(arguments)&&this.getEditor().completeEdit()},getEditor:function(){var a=this;if(!a.editor){a.editor=a.initEditor()}return a.editor},getContextFieldValues:function(){var f=this.editor,b=this.context,e=b.record,k={},c={},h=f.query(">[isFormField]"),g=h.length,d,a,j;for(d=0;d<g;d++){j=h[d];a=j.dataIndex;k[a]=j.getValue();c[a]=e.get(a)}Ext.apply(b,{newValues:k,originalValues:c})},initEditor:function(){return new Ext.grid.RowEditor(this.initEditorConfig())},initEditorConfig:function(){var g=this,c=g.grid,h=g.view,d=c.headerCt,e=["saveBtnText","cancelBtnText","errorsText","dirtyText"],i,a=e.length,f={autoCancel:g.autoCancel,errorSummary:g.errorSummary,fields:d.getGridColumns(),hidden:true,view:h,editingPlugin:g},j;for(i=0;i<a;i++){j=e[i];if(Ext.isDefined(g[j])){f[j]=g[j]}}return f},initEditTriggers:function(){var b=this,a=b.view,c=b.clicksToMoveEditor===1?"click":"dblclick";b.callParent(arguments);if(b.clicksToMoveEditor!==b.clicksToEdit){b.mon(a,"cell"+c,b.moveEditorByClick,b)}a.on({render:function(){b.mon(b.grid.headerCt,{scope:b,columnresize:b.onColumnResize,columnhide:b.onColumnHide,columnshow:b.onColumnShow})},single:true})},moveEditorByClick:function(){var a=this;if(a.editing){a.superclass.onCellClick.apply(a,arguments)}},onColumnAdd:function(a,c){if(c.isHeader){var d=this,b;d.initFieldAccessors(c);b=d.editor;if(b){b.onColumnAdd(c)}}},beforeGridHeaderDestroy:function(f){var c=this.grid.getColumnManager().getColumns(),a=c.length,b,d,e;for(b=0;b<a;b++){d=c[b];if(d.hasEditor){if(d.hasEditor()&&(e=d.getEditor())){e.destroy()}this.removeFieldAccessors(d)}}},onColumnResize:function(a,d,c){if(d.isHeader){var e=this,b=e.getEditor();if(b){b.onColumnResize(d,c)}}},onColumnHide:function(a,c){var d=this,b=d.getEditor();if(b){b.onColumnHide(c)}},onColumnShow:function(a,c){var d=this,b=d.getEditor();if(b){b.onColumnShow(c)}},onColumnMove:function(a,d,c,f){var e=this,b=e.getEditor();e.initFieldAccessors(d);if(b){b.onColumnMove(d,c,f)}},setColumnField:function(b,d){var c=this,a=c.getEditor();if(a){a.destroyColumnEditor(b)}c.callParent(arguments);if(a){a.insertColumnEditor(b)}},createColumnField:function(c,a){var b=this.editor,d;if(b){d=b.getDefaultFieldCfg()}return this.callParent([c,a||d])}});Ext.define("wys.plugs.RowExpander",{extend:"Ext.grid.plugin.RowExpander"});Ext.define("wys.plugs.TabClose",{extend:"Ext.plugin.Abstract",alias:"plugin.tabclosemenu",mixins:{observable:"Ext.util.Observable"},closeTabText:"关闭当前标签",showCloseOthers:true,closeOthersTabsText:"关闭其他标签",showCloseAll:true,closeAllTabsText:"关闭所有标签",extraItemsHead:null,extraItemsTail:null,constructor:function(a){this.callParent([a]);this.mixins.observable.constructor.call(this,a)},init:function(a){this.tabPanel=a;this.tabBar=a.down("tabbar");this.mon(this.tabPanel,{scope:this,afterlayout:this.onAfterLayout,single:true})},onAfterLayout:function(){this.mon(this.tabBar.el,{scope:this,contextmenu:this.onContextMenu,delegate:".x-tab"})},destroy:function(){this.callParent();Ext.destroy(this.menu)},onContextMenu:function(d,f){var c=this,g=c.createMenu(),e=true,h=true,b=c.tabBar.getChildByElement(f),a=c.tabBar.items.indexOf(b);c.item=c.tabPanel.getComponent(a);g.child("#close").setDisabled(!c.item.closable);if(c.showCloseAll||c.showCloseOthers){c.tabPanel.items.each(function(i){if(i.closable){e=false;if(i!==c.item){h=false;return false}}return true});if(c.showCloseAll){g.child("#closeAll").setDisabled(e)}if(c.showCloseOthers){g.child("#closeOthers").setDisabled(h)}}d.preventDefault();c.fireEvent("beforemenu",g,c.item,c);g.showAt(d.getXY())},createMenu:function(){var b=this;if(!b.menu){var a=[{itemId:"close",text:b.closeTabText,iconCls:"fa fa-close fa-fw",scope:b,handler:b.onClose}];if(b.showCloseAll||b.showCloseOthers){a.push("-")}if(b.showCloseOthers){a.push({itemId:"closeOthers",iconCls:"fa fa-share-alt fa-fw",text:b.closeOthersTabsText,scope:b,handler:b.onCloseOthers})}if(b.showCloseAll){a.push({itemId:"closeAll",text:b.closeAllTabsText,scope:b,iconCls:"fa fa-reply-all fa-fw",handler:b.onCloseAll})}if(b.extraItemsHead){a=b.extraItemsHead.concat(a)}if(b.extraItemsTail){a=a.concat(b.extraItemsTail)}b.menu=Ext.create("Ext.menu.Menu",{items:a,listeners:{hide:b.onHideMenu,scope:b}})}return b.menu},onHideMenu:function(){var a=this;a.fireEvent("aftermenu",a.menu,a)},onClose:function(){this.tabPanel.remove(this.item)},onCloseOthers:function(){this.doClose(true)},onCloseAll:function(){this.doClose(false)},doClose:function(b){var a=[];this.tabPanel.items.each(function(c){if(c.closable){if(!b||c!==this.item){a.push(c)}}},this);Ext.suspendLayouts();Ext.Array.forEach(a,function(c){this.tabPanel.remove(c)},this);Ext.resumeLayouts(true)}});Ext.define("wys.plugs.charts.HeightCharts",{extend:"Ext.panel.Panel",xtype:"charts",panelTitle:null,chartTitle:null,requires:["Ext.panel.Panel"],highchart:null,chartColumn:[],chartData:[],initComponent:function(){var a=this;if(a.panelTitle){a.title=a.panelTitle}a.border=1;this.callParent(arguments)},afterComponentLayout:function(c,a,b,f){var d=this;var e=d.id+"-body";d.highchart=new Highcharts.Chart({chart:{renderTo:e,animation:false},title:{text:d.chartTitle},credits:{text:constants.tip.sysName,href:constants.tip.sysURL},colors:constants.chartsColor,xAxis:{categories:d.chartColumn},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:""},legend:{layout:"vertical",align:"right",verticalAlign:"middle",borderWidth:0},series:d.chartData})}});Ext.define("wys.plugs.charts.HeightChartsHistogram",{extend:"Ext.panel.Panel",xtype:"charts_histogram",panelTitle:null,chartTitle:null,requires:["Ext.panel.Panel"],highchart:null,plotOptions:{column:{depth:0}},chartColumn:[],chartData:[],initComponent:function(){var a=this;if(a.panelTitle){a.title=a.panelTitle}a.border=1;this.callParent(arguments)},afterComponentLayout:function(c,a,b,f){var d=this;var e=d.id+"-body";d.highchart=new Highcharts.Chart({credits:{text:constants.tip.sysName,href:constants.tip.sysURL},colors:constants.chartsColor,chart:{renderTo:e,type:"column",margin:75,options3d:{enabled:true,alpha:0,beta:15,depth:0,viewDistance:25}},yAxis:{title:{text:"单位（台）"}},title:{text:d.chartTitle},plotOptions:d.plotOptions,xAxis:{categories:d.chartColumn},series:d.chartData})}});Ext.define("wys.plugs.charts.HeightChartsPie",{extend:"Ext.panel.Panel",panelTitle:null,xtype:"charts_pie",chartTitle:null,requires:["Ext.panel.Panel"],highchart:null,chartColumn:[],chartData:[],units:"",initComponent:function(){var a=this;if(a.panelTitle){a.title=a.panelTitle}a.border=1;this.callParent(arguments)},afterComponentLayout:function(c,a,b,f){var d=this;var e=d.id+"-body";d.highchart=new Highcharts.Chart({credits:{text:constants.tip.sysName,href:constants.tip.sysURL},colors:constants.chartsColor,chart:{renderTo:e,type:"pie",options3d:{enabled:true,alpha:45,beta:0}},title:{text:d.chartTitle},plotOptions:{pie:{allowPointSelect:true,cursor:"pointer",depth:35,dataLabels:{enabled:true,format:"{point.name} <br/> {point.y}台"}}},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},series:d.chartData})}});Ext.define("wys.tab.Panel",{extend:"Ext.tab.Panel"});Ext.define("wys.toolbar.NoInputPaging",{extend:"Ext.toolbar.Paging",xtype:"toolbar-noinputpaging",displayInfo:false,isShow:false,onClick:function(c){var a=this;var b=a.down("[reference= 'updateNoticeNav']").items.items;Ext.each(b,function(d){d.setPressed(false)});c.setPressed(true);c.up("window-updateNotice").getViewModel().set("currentUpdateNotice",c.initialConfig.data.noticeDetail);c.up("window-updateNotice").getViewModel().set("updateDate",Ext.util.Format.date(c.initialConfig.data.publishDate,"Y-m-d"))},setStore:function(b){var a=this;a.bindStore(b);a.updateNavItems(b)},getPagingItems:function(){var a=this;return[{itemId:"prev",tooltip:a.prevText,overflowText:a.prevText,iconCls:Ext.baseCSSPrefix+"tbar-page-prev",disabled:true,handler:a.movePrevious,scope:a},{xtype:"fieldcontainer",layout:"hbox",reference:"updateNoticeNav",defaults:{xtype:"button",width:20,height:20,ui:"toggleCricleButton",margin:"0 5",listeners:{click:Ext.bind(a.onClick,a)}},items:[]},{itemId:"next",tooltip:a.nextText,overflowText:a.nextText,iconCls:Ext.baseCSSPrefix+"tbar-page-next",disabled:true,handler:a.moveNext,scope:a}]},movePrevious:function(){var c=this,a=c.store,b=a.currentPage-1;if(b>0){if(c.fireEvent("beforechange",c,b)!==false){a.previousPage();c.updateNavItems(a);return true}}return false},moveNext:function(){var d=this,a=d.store,c=d.getPageData().pageCount,b=a.currentPage+1;if(b<=c){if(d.fireEvent("beforechange",d,b)!==false){a.nextPage();d.updateNavItems(a);return true}}return false},updateNavItems:function(c){var b=this,e=[],a;var d=b.down("[reference=updateNoticeNav]");d.removeAll();a=b.getPageData();Ext.each(c.config.data,function(g,f,h){if(f+1>a.fromRecord-1&&f+1<a.toRecord+1){e.push({text:f+1,data:g})}});d.add(e);if(d.items.length>0){d.items.items[0].fireEvent("click",d.items.items[0])}},initComponent:function(){var a=this,b;b=a.getPagingItems();a.callParent()}});Ext.define("wys.ux.TabClose",{extend:"Ext.plugin.Abstract",alias:"plugin.tabclosemenu",mixins:{observable:"Ext.util.Observable"},closeTabText:"关闭当前标签",showCloseOthers:true,closeOthersTabsText:"关闭其他标签",showCloseAll:true,closeAllTabsText:"关闭所有标签",extraItemsHead:null,extraItemsTail:null,constructor:function(a){this.callParent([a]);this.mixins.observable.constructor.call(this,a)},init:function(a){this.tabPanel=a;this.tabBar=a.down("tabbar");this.mon(this.tabPanel,{scope:this,afterlayout:this.onAfterLayout,single:true})},onAfterLayout:function(){this.mon(this.tabBar.el,{scope:this,contextmenu:this.onContextMenu,delegate:".x-tab"})},destroy:function(){this.callParent();Ext.destroy(this.menu)},onContextMenu:function(d,f){var c=this,g=c.createMenu(),e=true,h=true,b=c.tabBar.getChildByElement(f),a=c.tabBar.items.indexOf(b);c.item=c.tabPanel.getComponent(a);g.child("#close").setDisabled(!c.item.closable);if(c.showCloseAll||c.showCloseOthers){c.tabPanel.items.each(function(i){if(i.closable){e=false;if(i!==c.item){h=false;return false}}return true});if(c.showCloseAll){g.child("#closeAll").setDisabled(e)}if(c.showCloseOthers){g.child("#closeOthers").setDisabled(h)}}d.preventDefault();c.fireEvent("beforemenu",g,c.item,c);g.showAt(d.getXY())},createMenu:function(){var b=this;if(!b.menu){var a=[{itemId:"close",text:b.closeTabText,iconCls:"fa fa-close fa-fw",scope:b,handler:b.onClose}];if(b.showCloseAll||b.showCloseOthers){a.push("-")}if(b.showCloseOthers){a.push({itemId:"closeOthers",iconCls:"fa fa-share-alt fa-fw",text:b.closeOthersTabsText,scope:b,handler:b.onCloseOthers})}if(b.showCloseAll){a.push({itemId:"closeAll",text:b.closeAllTabsText,scope:b,iconCls:"fa fa-reply-all fa-fw",handler:b.onCloseAll})}if(b.extraItemsHead){a=b.extraItemsHead.concat(a)}if(b.extraItemsTail){a=a.concat(b.extraItemsTail)}b.menu=Ext.create("Ext.menu.Menu",{items:a,listeners:{hide:b.onHideMenu,scope:b}})}return b.menu},onHideMenu:function(){var a=this;a.fireEvent("aftermenu",a.menu,a)},onClose:function(){this.tabPanel.remove(this.item)},onCloseOthers:function(){this.doClose(true)},onCloseAll:function(){this.doClose(false)},doClose:function(b){var a=[];this.tabPanel.items.each(function(c){if(c.closable){if(!b||c!==this.item){a.push(c)}}},this);Ext.suspendLayouts();Ext.Array.forEach(a,function(c){this.tabPanel.remove(c)},this);Ext.resumeLayouts(true)}});Ext.define("wys.ux.combobox.CombGrid",{extend:"Ext.form.field.ComboBox",alias:"widget.combgrid",multiSelect:false,editable:false,gridWidth:650,gridHeight:300,isCheckBox:true,searchItems:[],createPicker:function(){var e=this;var b=Ext.create("wys.basic.BaseView",{store:e.store,frame:true,resizable:true,columns:e.columns,selModel:e.isCheckBox?Ext.create("Ext.selection.CheckboxModel",{mode:e.multiSelect?"SIMPLE":"SINGLE"}):{mode:e.multiSelect?"SIMPLE":"SINGLE"},floating:true,hidden:true,viewConfig:{emptyText:'<div style="text-align:center">没有找到相关记录<div>'},width:e.gridWidth,height:e.gridHeight,columnLines:false,focusOnToFront:false});if(!Ext.isEmpty(e.title)){b.setTitle(e.title)}if(e.paging){b.addDocked(Ext.create("Ext.PagingToolbar",{store:e.store,dock:"bottom"}))}if(e.searchItems){e.searchItems_temp=[];if(typeof e.searchItems!="object"){util.err("查询列类型为Array");return}e.searchItems_temp.push(e.searchItems[0]);var c={xtype:"searchBtn",handler:function(g){var f=b.getStore();f.proxy.extraParams=g.up("toolbar").down("baseForm")==null?{}:g.up("toolbar").down("baseForm").getValues();f.currentPage=1;f.reload()}};if(Ext.Array.indexOf(e.searchItems_temp,c)===-1){e.searchItems_temp.push(c)}b.addDocked({xtype:"toolbar",items:e.searchItems_temp,dock:"top"})}if(e.isBeforeLoad){var a=b.getStore();var d=b.down("toolbar").down("baseForm");a.proxy.extraParams=d===null?{}:d.getValues();a.currentPage=1;a.load()}e.mon(b,{itemclick:e.onItemClick,refresh:function(){},scope:e});e.mon(b.getSelectionModel(),{beforeselect:function(f){},beforedeselect:function(f){},selectionchange:e.onListSelectionChange,scope:e});this.picker=b;return b},onItemClick:function(c,a){var e=this,d=e.picker.getSelectionModel().getSelection(),b=e.valueField;if(!e.multiSelect&&d.length){a.get(b),d[0].get(b);if(a.get(b)===d[0].get(b)){e.displayTplData=[a.data];e.setRawValue(e.getDisplayValue());e.collapse()}}else{}},matchFieldWidth:false,onListSelectionChange:function(b,d){var a=this,e=a.multiSelect,c=d.length>0;if(!a.ignoreSelection&&a.isExpanded){if(!e){Ext.defer(a.collapse,1,a)}if(e||c){a.setValue(d,false)}if(c){a.fireEvent("select",a,d)}}},doAutoSelect:function(){var e=this,d=e.picker,f,g;if(d&&e.autoSelect&&e.store.getCount()>0){f=d.getSelectionModel().lastSelected;g=d.view.getNode(f||0);var b=[];if(!Ext.isEmpty(e.getValue())){for(var c=0;c<e.getValue().length;c++){var a=e.store.findRecord("bizCode",e.getValue()[c]);b.push(a)}}if(g){d.view.highlightItem(g);d.view.el.scrollChildIntoView(g,false)}}},onChange:function(f,e,i,h){var g=this;g.setValue(f)}});Ext.define("wys.ux.rating.Picker",{extend:"Ext.Widget",xtype:"myRating",focusable:true,cachedConfig:{family:"monospace",glyphs:"☆★",minimum:1,limit:5,overStyle:null,rounding:1,scale:"125%",selectedStyle:null,tooltip:null,trackOver:true,value:0,tooltipText:null,trackingValue:null},config:{animate:null},element:{cls:"u"+Ext.baseCSSPrefix+"rating-picker",reference:"element",children:[{reference:"innerEl",cls:"u"+Ext.baseCSSPrefix+"rating-picker-inner",listeners:{click:"onClick",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},children:[{reference:"valueEl",cls:"u"+Ext.baseCSSPrefix+"rating-picker-value"},{reference:"trackerEl",cls:"u"+Ext.baseCSSPrefix+"rating-picker-tracker"}]}]},defaultBindProperty:"value",twoWayBindable:"value",overCls:"u"+Ext.baseCSSPrefix+"rating-picker-over",trackOverCls:"u"+Ext.baseCSSPrefix+"rating-picker-track-over",applyGlyphs:function(a){if(typeof a==="string"){a=[a.charAt(0),a.charAt(1)]}else{if(typeof a[0]==="number"){a=[String.fromCharCode(a[0]),String.fromCharCode(a[1])]}}return a},applyOverStyle:function(a){this.trackerEl.applyStyles(a)},applySelectedStyle:function(a){this.valueEl.applyStyles(a)},applyTooltip:function(a){if(a&&typeof a!=="function"){if(!a.isTemplate){a=new Ext.XTemplate(a)}a=a.apply.bind(a)}return a},applyTrackingValue:function(a){return this.applyValue(a)},applyValue:function(c){if(c!==null){var b=this.getRounding(),a=this.getLimit(),d=this.getMinimum();c=Math.round(Math.round(c/b)*b*1000)/1000;c=(c<d)?d:(c>a?a:c)}return c},onClick:function(a){var b=this.valueFromEvent(a);this.setValue(b)},onMouseEnter:function(){this.element.addCls(this.overCls)},onMouseLeave:function(){this.element.removeCls(this.overCls)},onMouseMove:function(a){var b=this.valueFromEvent(a);this.setTrackingValue(b)},updateFamily:function(a){this.element.setStyle("fontFamily","'"+a+"'")},updateGlyphs:function(){this.refreshGlyphs()},updateLimit:function(){this.refreshGlyphs()},updateScale:function(a){this.element.setStyle("fontSize",a)},updateTooltip:function(){this.refreshTooltip()},updateTooltipText:function(e){var d=this.innerEl,a=Ext.tip&&Ext.tip.QuickTipManager,b=a&&a.tip,c;if(a){d.dom.setAttribute("data-qtip",e);this.trackerEl.dom.setAttribute("data-qtip",e);c=b&&b.activeTarget;c=c&&c.el;if(c&&d.contains(c)){b.update(e)}}},updateTrackingValue:function(d){var c=this,a=c.trackerEl,b=c.valueToPercent(d);a.setStyle("width",b);c.refreshTooltip()},updateTrackOver:function(a){this.element[a?"addCls":"removeCls"](this.trackOverCls)},updateValue:function(h,c){var f=this,b=f.getAnimate(),g=f.valueEl,e=f.valueToPercent(h),d,a;if(f.isConfiguring||!b){g.setStyle("width",e)}else{g.stopAnimation();g.animate(Ext.merge({from:{width:f.valueToPercent(c)},to:{width:e}},b))}f.refreshTooltip();if(!f.isConfiguring){if(f.hasListeners.change){f.fireEvent("change",f,h,c)}d=f.getWidgetColumn&&f.getWidgetColumn();a=d&&f.getWidgetRecord&&f.getWidgetRecord();if(a&&d.dataIndex){a.set(d.dataIndex,h)}}},afterCachedConfig:function(){this.refresh();return this.callParent(arguments)},initConfig:function(a){this.isConfiguring=true;this.callParent([a]);this.refresh()},setConfig:function(){var a=this;a.isReconfiguring=true;a.callParent(arguments);a.isReconfiguring=false;a.refresh();return a},destroy:function(){this.tip=Ext.destroy(this.tip);this.callParent()},privates:{getGlyphTextNode:function(b){var a=b.lastChild;if(!a||a.nodeType!==3){a=b.ownerDocument.createTextNode("");b.appendChild(a)}return a},getTooltipData:function(){var a=this;return{component:a,tracking:a.getTrackingValue(),trackOver:a.getTrackOver(),value:a.getValue()}},refresh:function(){var a=this;if(a.invalidGlyphs){a.refreshGlyphs(true)}if(a.invalidTooltip){a.refreshTooltip(true)}},refreshGlyphs:function(a){var i=this,g=!a&&(i.isConfiguring||i.isReconfiguring),c,j,f,h,e,b,d;if(!g){c=i.getGlyphTextNode(i.innerEl.dom);d=i.getGlyphTextNode(i.valueEl.dom);b=i.getGlyphTextNode(i.trackerEl.dom);j=i.getGlyphs();f=i.getLimit();for(h=e="";f--;){e+=j[0];h+=j[1]}c.nodeValue=e;d.nodeValue=h;b.nodeValue=h}i.invalidGlyphs=g},refreshTooltip:function(b){var c=this,a=!b&&(c.isConfiguring||c.isReconfiguring),e=c.getTooltip(),d,f;if(!a){e=c.getTooltip();if(e){d=c.getTooltipData();f=e(d);c.setTooltipText(f)}}c.invalidTooltip=a},valueFromEvent:function(a){var f=this,b=f.innerEl,e=a.getX(),j=f.getRounding(),d=b.getX(),g=e-d,h=b.getWidth(),c=f.getLimit(),i;if(f.getInherited().rtl){g=h-g}i=g/h*c;i=Math.ceil(i/j)*j;return i},valueToPercent:function(a){a=(a/this.getLimit())*100;return a+"%"}}});Ext.define("wys.view.ProgressController",{extend:"Ext.app.ViewController",alias:"controller.progressCtrl"});Ext.define("wys.view.ProgressViewModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.progressViewModel",data:{},stores:{dataviewProgress:{type:"store",data:[{list:[{upMessage:"2017.06.19 物业系统前端框架确认",downMessage:"",status:"successed"},{upMessage:"",downMessage:"2017.06.20 物业系统后端框架雏形确认发生变更",status:"failed",failedMessage:"业务流程有变化"},{upMessage:"2017.06.23 物业系统前端展示页面正式进入开发",downMessage:"",status:"being",failedMessage:"物业系统前端展示页面正式进入开发"},{upMessage:"",downMessage:"2017.06.29 物业系统前端开发正式开始第一版本已确认有部分优化调整内容",status:"successed"}]}]},registerProgress:{type:"store",data:[{list:[{upMessage:"2017.06.19 提交注册申请",downMessage:"",status:"successed"},{upMessage:"",downMessage:"2017.06.20 信息填写不符",status:"failed",failedMessage:"企业组织机构编码填写有误"},{upMessage:"2017.06.23 审核成功",downMessage:"",status:"successed",failedMessage:"恭喜您，你的申请已通过"}]}]}}});Ext.define("wys.view.Progress",{extend:"Ext.view.View",xtype:"dataview-progress",requires:["wys.view.ProgressController","wys.view.ProgressViewModel"],controller:"progressCtrl",viewModel:"progressViewModel",bind:{store:"{dataviewProgress}"},itemSelector:".ui-progress-segment-main-icon-failed",initComponent:function(){var a=this;a.tpl=['<tpl for=".">','<div class="ui-progress">','<tpl for="list">','<div class="ui-progress-segment">','<div class="ui-progress-segment-main">','<div class="ui-progress-segment-main-up" title="{upMessage}">{upMessage}</div>','<div class="ui-progress-segment-main-icon ui-progress-segment-main-icon-{status}"></div>','<div class="ui-progress-segment-main-down title="{downMessage}">{downMessage}</div>',"</div>",'<div class="ui-progress-segment-bar"></div>','<tpl if="failedMessage">','<div class="ui-progress-segment-failed-popup"><span></span><em></em>{failedMessage}</div>',"</tpl>","</div>","</tpl>","</div>","</tpl>"];a.callParent()},listeners:{afterrender:function(b,a){b.on({element:"el",mouseover:function(g,f,d){if(f.className.indexOf("ui-progress-segment-main-icon-failed")!=-1){var c=Ext.query(".ui-progress-segment-failed-popup");c[0].style.display="block"}},mouseout:function(g,f,d){if(f.className.indexOf("ui-progress-segment-main-icon-failed")==-1){var c=Ext.query(".ui-progress-segment-failed-popup");c[0].style.display="none"}},scope:b})}}});Ext.define("wys.view.TimeLine",{extend:"Ext.view.View",xtype:"dataview-timeLine",itemSelector:"span.fa-circle",tpl:['<table align="left" class="timeline">',"<tr>",'<td height="30"></td>','<td width="30"><span class="treePoint" style="color: #157fcc;">','<div class="timer" style="margin-left:5px;transform:scale(.5,.5)">','<div style="width:40px;height:40px;border:2px solid #fff;border-radius:40px;margin:0 auto;margin-top:12px;"></div>','<div style="width:10px;height:10px;background-color:#3880dd;position:absolute;left:40px;top:42px;border-radius:10px;"></div>','<div style="width:12px;height:2px;background-color:#fff;position:absolute;left:30px;top:30px;"></div>','<div style="width:12px;height:2px;background-color:#fff;position:absolute;left:25px;top:25px;transform: rotate(90deg)"></div>',"</div>",'</span><div class="vertical"></div></td>',"</tr>",'<tpl for=".">','<tpl if="xindex==1">',"<tr>",'<td height="40">','<div class="caretRight" style="border-left-color:#ff9900;"></div>','<div class="shadow" style="background-color: #FF9900;padding:0px 5px;color:#fff"> {date}</div></td>','<td width="100"><span class="treePoint fa fa-circle" style="color: #FF9900;cursor: pointer;transform:scale(1.5,1.5)" data-color="#FF9900"></span><div class="vertical">{currentCostCenter}</div></td>',"</tr>",'<tpl elseif="xindex!=xcount">',"<tr>",'<td height="40">','<div class="caretRight" style="border-left-color:#008EF2;"></div>','<div class="shadow" style="background-color: #008EF2;padding:0px 5px;color:#fff"> {date}</div></td>','<td width="30"><span class="treePoint fa fa-circle" style="color:#008EF2;cursor: pointer;" data-color="#008EF2"></span><div class="vertical">{currentCostCenter}</div></td>',"</tr>","<tpl else>","<tr>",'<td height="40">','<div class="caretRight" style="border-left-color:#d5d5d5;"></div>','<div class="shadow" style="padding:0px 5px;"> {date}</div></td>','<td width="30"><span class="treePoint fa fa-circle" style="cursor: pointer;" data-color="#d5d5d5"></span><div class="vertical">{currentCostCenter}</div></td>',"</tr>","</tpl>","</tpl>","<tr>",'<td height="30"></td>','<td width="30"><span class="treePoint fa fa-circle-o" style="color:#3399CC;"></span></td>',"</tr>","</table>"],listeners:{itemclick:function(b,c,j,d,f,g){var i="cursor: pointer;transform:scale(1.5,1.5)",a="cursor: pointer;transform:scale(1,1)",h=Ext.query("span.fa-circle");Ext.each(h,function(e,l,k){var m=e.style.color;if(l==d){e.style=i;e.style.color=m}else{e.style=a;e.style.color=m}});b.up("pushWindow").down("panel[tag=timecontentBanner]").setStyle({zIndex:99999,left:"120px"});b.up("pushWindow").down("[tag=timecontentBanner]").setHtml('<div class="caretLeft" style="border-right-color:'+j.getAttribute("data-color")+';margin-top:3px;margin-left:0px;"></div><div class="shadow" style="width:290px;background-color: '+j.getAttribute("data-color")+';padding:0px 5px;color:#fff;text-align:center;">'+c.data.remarks+"</div>")}}});Ext.define("wys.window.CodeEditorWin",{extend:"Ext.window.Window",xtype:"codeEditorWin",requires:["Ext.window.Window","wys.basic.specialGridpanel"],closeAction:"destroy",initComponent:function(){var a=this;Ext.apply(a,{autoShow:true,title:a.title||"添加代码",iconCls:a.iconCls||"fa fa-code fa-lg",modal:true,maximizable:true,closeAction:"hide",layout:"fit",autoScroll:true,animCollapse:true,animateTarget:Ext.getBody(),border:true,style:"border-color: #b6babe;",closeToolText:"点击关闭窗口",width:a.width||Ext.getBody().getSize().width-100,height:a.height||Ext.getBody().getSize().height-100,listeners:{show:function(c){var b=CodeMirror.fromTextArea(Ext.getDom(c.down("textarea").id+"-inputEl"),{lineNumbers:true,indentUnit:4,styleActiveLine:true,matchBrackets:true,mode:a.type,lineWrapping:true,theme:"vibrant-ink"});b.on("changes",function(d,e){a.down("textarea").setValue(d.getValue())},this);b.setSize("auto",Ext.getCmp(c.down("textarea").id).getHeight()-3+"px")},close:function(b){b.down("textarea").setValue("")}},dockedItems:[{xtype:"toolbar",hidden:a.type==="JSON",style:"background:#f9f9f9;border-bottom-color:#ccc !important;border-bottom-width:1px !important;",dock:"top",items:["->",{text:"执行...",iconCls:"EDIT_ON",handler:function(b){a.execute(b)}}]},{xtype:"toolbar",hidden:a.type==="SQL",style:"background:#f9f9f9;border-bottom-color:#ccc !important;border-bottom-width:1px !important;",dock:"top",items:["->",{text:"调试...",iconCls:"DEBUGGER",handler:function(b){a.debuggerJSON(b)}}]}],items:[{xtype:"textarea",name:"sourceCode"}]});a.callParent()},execute:function(b){var c=this,a=this.down("textarea").getValue(),d=a;util.ajax({url:app.base+"/stat/resolveSQLToFields.do",params:{sql:d},ok:function(f){if(!f.success){util.err(f.msg_info)}else{var e=[[app.base+"/stat/resolveSQLToFields.do"],[app.base+"/stat/queryDatasBySql.do"]];Ext.create("Ext.window.Window",{title:"查询结果",width:c.width||Ext.getBody().getSize().width-100,height:c.height||Ext.getBody().getSize().height-100,items:[{xtype:"specialGridPanel",url:e,params:{sql:d}}]}).show()}}});return},debuggerJSON:function(a){var b=this;textareaValue=this.down("textarea").getValue(),executeJSON=textareaValue}});Ext.define("wys.window.HtmlShow",{extend:"Ext.window.Window",xtype:"htmlShowWin",ui:"htmlList",width:"100%",height:"100%",header:false,closable:true,closeAction:"destroy",isLocalData:true,localData:[],fileKey:"",modal:true,scrollable:true,style:{textAlign:"center"},align:"center",items:[{xtype:"button",iconCls:"fa icon-close",style:{background:"transparent",border:"none",fontSize:"50px",width:"60px",height:"60px"},scale:"large",x:"calc(100% - 50px)",y:0,handler:function(){this.up("window").destroy()}}],buttonAlign:"center",buttons:[{xtype:"button",text:"关闭",ui:"button-commonToolbarBtn-toolbar",iconCls:"fa fa-close",handler:function(){var a=this;var b=a.up("window");b.close()}}],initComponent:function(){var a=this;a.callParent();util.ajax({url:constants.url.attachment.wordToHtml,params:{fileKey:a.fileKey},ok:function(b){if(b.success){a.setHtml(b.root)}else{util.err(b.msg_info)}}})}});Ext.define("wys.window.PicShow",{extend:"Ext.window.Window",xtype:"picShowWin",ui:"picList",width:800,height:600,header:false,closable:true,animCollapse:true,closeAction:"destroy",isLocalData:true,localData:[],imgSrc:"",modal:true,layout:"absolute",align:"center",scrollable:true,style:"background-color:#ebebeb",bodyStyle:"background-color:transparent",items:[{xtype:"image",x:"50%",y:"50%",src:"",cls:"my-showPic",itemId:"picShow",afterRender:function(a){new Ext.dd.DD(Ext.getCmp(this.id),"pic");Ext.get(this.id).dom.title="鼠标滚轮控制图片的放大和缩小";Ext.get(this.id).on("dblclick",function(){util.zoom(Ext.getCmp(this.id),1.5,true)});Ext.get(this.id).on("mousewheel",function(b){var c=b.getWheelDelta();if(c>0){util.zoom(Ext.getCmp(this.id),1.5,true)}else{util.zoom(Ext.getCmp(this.id),1.5,false)}})}}],buttonAlign:"center",buttons:[{xtype:"button",text:"关闭",ui:"button-commonToolbarBtn-toolbar",iconCls:"fa fa-close",handler:function(){var a=this;var b=a.up("window");b.close()}}],initComponent:function(){var b=this;b.callParent();var c=b;var a=c.down("image");a.setSrc(b.imgSrc)}});Ext.define("wys.window.PluginNotInstallWin",{extend:"Ext.window.Window",alias:"widget.pluginNotInstallWin",requires:["Ext.container.Container","Ext.toolbar.Spacer","Ext.form.Label"],tipText:"",initComponent:function(){var a=this;Ext.apply(a,{closeToolText:"关闭窗口",autoShow:true,cls:"error-page-container",closable:true,title:"系统检测到您有未安装的系统所需插件",titleAlign:"center",modal:true,minWidth:300,minheight:150,layout:{type:"vbox",align:"center",pack:"center"},items:[{xtype:"container",layout:{type:"vbox",align:"center",pack:"center"},items:[{xtype:"label",cls:"error-page-desc",margin:8,html:this.tipText},{xtype:"tbspacer",flex:1}]}],listeners:{show:function(c,b){Ext.EventManager.stopEvent(this);b.stopPropagation();return}}});a.callParent()},onCloseWindow:function(){var a=this;a.fireEvent("closeAnimate",a);Ext.defer(function(){a.close()},500,a)}});Ext.define("wys.window.UpdateNotice",{extend:"Ext.window.Window",xtype:"window-updateNotice",ui:"updateNotice",header:false,resizable:false,closable:true,modal:true,width:683,height:440,requires:["wys.toolbar.NoInputPaging"],style:"background-color:#fff;",dockedItems:[{xtype:"panel",dock:"top",cls:"updateWinBg",bodyStyle:"background-color:transparent;",width:683,height:153,bind:{html:'<div class="updateNoticeHeader"><p>{title}</p><div>{updateDate}</div></div>'},items:[{xtype:"tool",type:"close",style:"float:right;margin-right:10px;margin-top:10px;",handler:function(){arguments[2].up("window-updateNotice").close()}}]},{xtype:"toolbar",dock:"bottom",style:"background-color:#ffffff;border-top:1px solid #efefef!important",items:["->",{xtype:"button",iconCls:"fa fa-upload",text:"更新系统",handler:function(a){Ext.MessageBox.show({wait:true,height:50,waitConfig:{interval:1,increment:280,text:'<span class="app-normal">正在更新系统，请稍后</span>'}});Ext.defer(function(){window.location.reload()},1000)}},"->"]}],items:[{xtype:"panel",bodyStyle:"background-color:#ffffff;",cls:"updateNoticePanel",width:663,height:227,scrollable:"y",padding:"5 0 0 35",items:[{xtype:"dataview",height:200,bind:"{updateNotice}",itemSelector:"tr",tpl:["<table>",'<tpl for=".">',"<tr>",'<td style="vertical-align: top">{#}.</td>',"<td>{content}</td>","</tr>","</tpl>","</table>"]}]}],initComponent:function(){var a=this;a.callParent()}});Ext.define("wys.window.Window",{extend:"Ext.window.Window",xtype:"pushWindow",closeAction:"destroy",initComponent:function(){var c=this;var a,d,b;c.floating=true;billname=c.billName||[];a=c.billData.name;c.items=[{xtype:"panel",margin:"5 5 5 5",minWidth:Ext.Element.getViewportWidth()*0.4,autoWidth:true,layout:{type:"vbox"},items:[{xtype:"button",text:"关闭",ui:"button-commonToolbarBtn-toolbar",iconCls:"fa fa-close",listeners:{click:Ext.bind(c.onCloseWindow,c)}},{xtype:"panel",tag:"timecontentBanner"},{width:Ext.Element.getViewportWidth()*0.3,items:c.billData}]}];c.listeners={show:{fn:function(){c.getEl().fadeIn({easing:"easeOut",duration:500,from:{width:0,opacity:0,color:"#ffffff",right:0},to:{width:document.body.clientWidth-230,height:document.body.clientHeight-150,left:Ext.Element.getViewportWidth()*0.4}})}},closeAnimate:{fn:function(){c.getEl().fadeIn({duration:500,from:{left:Ext.Element.getViewportWidth()*0.4},to:{left:document.body.clientWidth}})}}};c.callParent()},onCloseWindow:function(){var a=this;a.fireEvent("closeAnimate",a);Ext.defer(function(){a.close()},500,a)}});